





<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://assets-cdn.github.com">
  <link rel="dns-prefetch" href="https://avatars0.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars1.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars2.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">



  <link crossorigin="anonymous" media="all" integrity="sha512-PkbtxdWDpLChpxtWQ0KbvJoef4XMYPq5pfd/ZmylYZTzXYpCfGwN9d+bsSKcmOJLwTkfjFkfj5wz3poDrhJoSQ==" rel="stylesheet" href="https://assets-cdn.github.com/assets/frameworks-f6e6ce21346c0d2eb22def1e8534afcb.css" />
  <link crossorigin="anonymous" media="all" integrity="sha512-LHNZGPA72iEyT2UIFOpxTPnfDcJ1Ecx8MKZgMzCJzkqfID/5niECnSBbRtDc4LDgbI3YDHu5dgs5mQiMmum6cA==" rel="stylesheet" href="https://assets-cdn.github.com/assets/github-caf1b1f61473986b3fdfa6e73e76a94f.css" />
  
  
  <link crossorigin="anonymous" media="all" integrity="sha512-zyxweUSm/NG+juywqcMFSS4HbKjLWCZyEM2JjoCqnQUU6RVrHpHMwH66xreiaeMIRoA6vYuk0hm8S1X42r/YWQ==" rel="stylesheet" href="https://assets-cdn.github.com/assets/site-220df28424b63d1e24f3bd909efebe81.css" />
  

  <meta name="viewport" content="width=device-width">
  
  <title>docker.github.io/index.md at master · docker/docker.github.io · GitHub</title>
    <meta name="description" content="GitHub is where people build software. More than 28 million people use GitHub to discover, fork, and contribute to over 85 million projects.">
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">
  <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
  <meta property="fb:app_id" content="1401488693436528">

    
    <meta property="og:image" content="https://avatars2.githubusercontent.com/u/5429470?s=400&amp;v=4" /><meta property="og:site_name" content="GitHub" /><meta property="og:type" content="object" /><meta property="og:title" content="docker/docker.github.io" /><meta property="og:url" content="https://github.com/docker/docker.github.io" /><meta property="og:description" content="docker.github.io - Source repo for Docker&#39;s Documentation" />

  <link rel="assets" href="https://assets-cdn.github.com/">
  
  <meta name="pjax-timeout" content="1000">
  
  <meta name="request-id" content="68BC:70C8:96D25F:DCFEED:5B19EBEE" data-pjax-transient>


  

  <meta name="selected-link" value="repo_source" data-pjax-transient>

    <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
  <meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
  <meta name="google-site-verification" content="GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc">
    <meta name="google-analytics" content="UA-3769691-2">

<meta name="octolytics-host" content="collector.githubapp.com" /><meta name="octolytics-app-id" content="github" /><meta name="octolytics-event-url" content="https://collector.githubapp.com/github-external/browser_event" /><meta name="octolytics-dimension-request_id" content="68BC:70C8:96D25F:DCFEED:5B19EBEE" /><meta name="octolytics-dimension-region_edge" content="ap-southeast-1" /><meta name="octolytics-dimension-region_render" content="iad" />
<meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-pjax-transient="true" />




  <meta class="js-ga-set" name="dimension1" content="Logged Out">


  

      <meta name="hostname" content="github.com">
    <meta name="user-login" content="">

      <meta name="expected-hostname" content="github.com">
    <meta name="js-proxy-site-detection-payload" content="MzE4Yjk1NzgzOGQ1MzQxMTJiZmQzMzVkMWY1NzAwZjdiY2Y0NjBmMjIxMGE2MzQ3YmE1OTY3ZjhiYjE4MmJhN3x7InJlbW90ZV9hZGRyZXNzIjoiMjIyLjIxNy4xNDEuMiIsInJlcXVlc3RfaWQiOiI2OEJDOjcwQzg6OTZEMjVGOkRDRkVFRDo1QjE5RUJFRSIsInRpbWVzdGFtcCI6MTUyODQyNTQ1NSwiaG9zdCI6ImdpdGh1Yi5jb20ifQ==">

    <meta name="enabled-features" content="UNIVERSE_BANNER,FREE_TRIALS,MARKETPLACE_INSIGHTS,MARKETPLACE_INSIGHTS_CONVERSION_PERCENTAGES">

  <meta name="html-safe-nonce" content="2cb16abee1ba2bf1c5007154e88bc7918ec37366">

  <meta http-equiv="x-pjax-version" content="474ab0b0581ad949b1ccd2ec62e46bb5">
  

      <link href="https://github.com/docker/docker.github.io/commits/master.atom" rel="alternate" title="Recent Commits to docker.github.io:master" type="application/atom+xml">

  <meta name="description" content="docker.github.io - Source repo for Docker&#39;s Documentation">
  <meta name="go-import" content="github.com/docker/docker.github.io git https://github.com/docker/docker.github.io.git">

  <meta name="octolytics-dimension-user_id" content="5429470" /><meta name="octolytics-dimension-user_login" content="docker" /><meta name="octolytics-dimension-repository_id" content="65772720" /><meta name="octolytics-dimension-repository_nwo" content="docker/docker.github.io" /><meta name="octolytics-dimension-repository_public" content="true" /><meta name="octolytics-dimension-repository_is_fork" content="false" /><meta name="octolytics-dimension-repository_network_root_id" content="65772720" /><meta name="octolytics-dimension-repository_network_root_nwo" content="docker/docker.github.io" /><meta name="octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown" content="false" />


    <link rel="canonical" href="https://github.com/docker/docker.github.io/blob/master/compose/compose-file/index.md" data-pjax-transient>


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://assets-cdn.github.com/pinned-octocat.svg" color="#000000">
  <link rel="icon" type="image/x-icon" class="js-site-favicon" href="https://assets-cdn.github.com/favicon.ico">

<meta name="theme-color" content="#1e2327">



<link rel="manifest" href="/manifest.json" crossOrigin="use-credentials">

  </head>

  <body class="logged-out env-production page-blob">
    

  <div class="position-relative js-header-wrapper ">
    <a href="#start-of-content" tabindex="1" class="px-2 py-4 bg-blue text-white show-on-focus js-skip-to-content">Skip to content</a>
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"><div class="progress"></div></div>

    
    
    



        <header class="Header header-logged-out  position-relative f4 py-3" role="banner">
  <div class="container-lg d-flex px-3">
    <div class="d-flex flex-justify-between flex-items-center">
      <a class="header-logo-invertocat my-0" href="https://github.com/" aria-label="Homepage" data-ga-click="(Logged out) Header, go to homepage, icon:logo-wordmark">
        <svg height="32" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
      </a>

    </div>

    <div class="HeaderMenu HeaderMenu--bright d-flex flex-justify-between flex-auto">
        <nav class="mt-0">
          <ul class="d-flex list-style-none">
              <li class="ml-2">
                <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:features" data-selected-links="/features /features/project-management /features/code-review /features/project-management /features/integrations /features" href="/features">
                  Features
</a>              </li>
              <li class="ml-4">
                <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:business" data-selected-links="/business /business/security /business/customers /business" href="/business">
                  Business
</a>              </li>

              <li class="ml-4">
                <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:explore" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore" href="/explore">
                  Explore
</a>              </li>

              <li class="ml-4">
                    <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:marketplace" data-selected-links=" /marketplace" href="/marketplace">
                      Marketplace
</a>              </li>
              <li class="ml-4">
                <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:pricing" data-selected-links="/pricing /pricing/developer /pricing/team /pricing/business-hosted /pricing/business-enterprise /pricing" href="/pricing">
                  Pricing
</a>              </li>
          </ul>
        </nav>

      <div class="d-flex">
          <div class="d-lg-flex flex-items-center mr-3">
            <div class="header-search scoped-search site-scoped-search js-site-search position-relative" role="search">
  <div class="position-relative">
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-site-search-form" data-scope-type="Repository" data-scope-id="65772720" data-scoped-search-url="/docker/docker.github.io/search" data-unscoped-search-url="/search" action="/docker/docker.github.io/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
      <label class="form-control header-search-wrapper  js-chromeless-input-container">
            <a class="header-search-scope no-underline" href="/docker/docker.github.io/blob/master/compose/compose-file/index.md">This repository</a>
        <input type="text"
          class="form-control header-search-input  js-site-search-focus js-site-search-field is-clearable"
          data-hotkey="s,/"
          name="q"
          value=""
          placeholder="Search"
          aria-label="Search this repository"
          data-unscoped-placeholder="Search GitHub"
          data-scoped-placeholder="Search"
          autocapitalize="off"
          >
          <input type="hidden" class="js-site-search-type-field" name="type" >
      </label>
</form>  </div>
</div>

          </div>

        <span class="d-inline-block">
            <div class="HeaderNavlink px-0 py-2 m-0">
              <a class="text-bold text-white no-underline" href="/login?return_to=%2Fdocker%2Fdocker.github.io%2Fblob%2Fmaster%2Fcompose%2Fcompose-file%2Findex.md" data-ga-click="(Logged out) Header, clicked Sign in, text:sign-in">Sign in</a>
                <span class="text-gray">or</span>
                <a class="text-bold text-white no-underline" href="/join?source=header-repo" data-ga-click="(Logged out) Header, clicked Sign up, text:sign-up">Sign up</a>
            </div>
        </span>
      </div>
    </div>
  </div>
</header>

  </div>

  <div id="start-of-content" class="show-on-focus"></div>

    <div id="js-flash-container">
</div>



  <div role="main" class="application-main ">
        <div itemscope itemtype="http://schema.org/SoftwareSourceCode" class="">
    <div id="js-repo-pjax-container" data-pjax-container >
      





  



  <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav  ">
    <div class="repohead-details-container clearfix container">

      <ul class="pagehead-actions">
  <li>
      <a href="/login?return_to=%2Fdocker%2Fdocker.github.io"
    class="btn btn-sm btn-with-count tooltipped tooltipped-n"
    aria-label="You must be signed in to watch a repository" rel="nofollow">
    <svg class="octicon octicon-eye" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"/></svg>
    Watch
  </a>
  <a class="social-count" href="/docker/docker.github.io/watchers"
     aria-label="135 users are watching this repository">
    135
  </a>

  </li>

  <li>
      <a href="/login?return_to=%2Fdocker%2Fdocker.github.io"
    class="btn btn-sm btn-with-count tooltipped tooltipped-n"
    aria-label="You must be signed in to star a repository" rel="nofollow">
    <svg class="octicon octicon-star" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"/></svg>
    Star
  </a>

    <a class="social-count js-social-count" href="/docker/docker.github.io/stargazers"
      aria-label="1049 users starred this repository">
      1,049
    </a>

  </li>

  <li>
      <a href="/login?return_to=%2Fdocker%2Fdocker.github.io"
        class="btn btn-sm btn-with-count tooltipped tooltipped-n"
        aria-label="You must be signed in to fork a repository" rel="nofollow">
        <svg class="octicon octicon-repo-forked" viewBox="0 0 10 16" version="1.1" width="10" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"/></svg>
        Fork
      </a>

    <a href="/docker/docker.github.io/network" class="social-count"
       aria-label="2458 users forked this repository">
      2,458
    </a>
  </li>
</ul>

      <h1 class="public ">
  <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"/></svg>
  <span class="author" itemprop="author"><a class="url fn" rel="author" href="/docker">docker</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a data-pjax="#js-repo-pjax-container" href="/docker/docker.github.io">docker.github.io</a></strong>

</h1>

    </div>
    
<nav class="reponav js-repo-nav js-sidenav-container-pjax container"
     itemscope
     itemtype="http://schema.org/BreadcrumbList"
     role="navigation"
     data-pjax="#js-repo-pjax-container">

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a class="js-selected-navigation-item selected reponav-item" itemprop="url" data-hotkey="g c" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /docker/docker.github.io" href="/docker/docker.github.io">
      <svg class="octicon octicon-code" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"/></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>

    <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" data-hotkey="g i" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /docker/docker.github.io/issues" href="/docker/docker.github.io/issues">
        <svg class="octicon octicon-issue-opened" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg>
        <span itemprop="name">Issues</span>
        <span class="Counter">311</span>
        <meta itemprop="position" content="2">
</a>    </span>

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a data-hotkey="g p" itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /docker/docker.github.io/pulls" href="/docker/docker.github.io/pulls">
      <svg class="octicon octicon-git-pull-request" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"/></svg>
      <span itemprop="name">Pull requests</span>
      <span class="Counter">42</span>
      <meta itemprop="position" content="3">
</a>  </span>

    <a data-hotkey="g b" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /docker/docker.github.io/projects" href="/docker/docker.github.io/projects">
      <svg class="octicon octicon-project" viewBox="0 0 15 16" version="1.1" width="15" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/></svg>
      Projects
      <span class="Counter" >0</span>
</a>


  <a class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors dependency_graph pulse /docker/docker.github.io/pulse" href="/docker/docker.github.io/pulse">
    <svg class="octicon octicon-graph" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z"/></svg>
    Insights
</a>

</nav>


  </div>

<div class="container new-discussion-timeline experiment-repo-nav  ">
  <div class="repository-content ">

    
  <a class="d-none js-permalink-shortcut" data-hotkey="y" href="/docker/docker.github.io/blob/b21c4c7339b1deae898db9ca31ee61628fbdb4c6/compose/compose-file/index.md">Permalink</a>

  <!-- blob contrib key: blob_contributors:v21:68725724aeab3e8c0dcae52e7ca70938 -->

  <div class="file-navigation">
    
<div class="select-menu branch-select-menu js-menu-container js-select-menu float-left">
  <button class=" btn btn-sm select-menu-button js-menu-target css-truncate" data-hotkey="w"
    
    type="button" aria-label="Switch branches or tags" aria-expanded="false" aria-haspopup="true">
      <i>Branch:</i>
      <span class="js-select-button css-truncate-target">master</span>
  </button>

  <div class="select-menu-modal-holder js-menu-content js-navigation-container" data-pjax>

    <div class="select-menu-modal">
      <div class="select-menu-header">
        <svg class="octicon octicon-x js-menu-close" role="img" aria-label="Close" viewBox="0 0 12 16" version="1.1" width="12" height="16"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
        <span class="select-menu-title">Switch branches/tags</span>
      </div>

      <div class="select-menu-filters">
        <div class="select-menu-text-filter">
          <input type="text" aria-label="Filter branches/tags" id="context-commitish-filter-field" class="form-control js-filterable-field js-navigation-enable" placeholder="Filter branches/tags">
        </div>
        <div class="select-menu-tabs">
          <ul>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="branches" data-filter-placeholder="Filter branches/tags" class="js-select-menu-tab" role="tab">Branches</a>
            </li>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="tags" data-filter-placeholder="Find a tag…" class="js-select-menu-tab" role="tab">Tags</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="branches" role="menu">

        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/d4m-k8s/compose/compose-file/index.md"
               data-name="d4m-k8s"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                d4m-k8s
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/docs-base/compose/compose-file/index.md"
               data-name="docs-base"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                docs-base
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/gh-pages/compose/compose-file/index.md"
               data-name="gh-pages"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                gh-pages
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open selected"
               href="/docker/docker.github.io/blob/master/compose/compose-file/index.md"
               data-name="master"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                master
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/publish-tools/compose/compose-file/index.md"
               data-name="publish-tools"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                publish-tools
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v1.4/compose/compose-file/index.md"
               data-name="v1.4"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v1.4
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v1.5/compose/compose-file/index.md"
               data-name="v1.5"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v1.5
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v1.6/compose/compose-file/index.md"
               data-name="v1.6"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v1.6
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v1.7/compose/compose-file/index.md"
               data-name="v1.7"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v1.7
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v1.8/compose/compose-file/index.md"
               data-name="v1.8"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v1.8
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v1.9/compose/compose-file/index.md"
               data-name="v1.9"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v1.9
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v1.10/compose/compose-file/index.md"
               data-name="v1.10"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v1.10
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v1.11/compose/compose-file/index.md"
               data-name="v1.11"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v1.11
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v1.12/compose/compose-file/index.md"
               data-name="v1.12"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v1.12
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v1.13/compose/compose-file/index.md"
               data-name="v1.13"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v1.13
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v17.03/compose/compose-file/index.md"
               data-name="v17.03"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v17.03
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v17.06/compose/compose-file/index.md"
               data-name="v17.06"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v17.06
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v17.09/compose/compose-file/index.md"
               data-name="v17.09"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v17.09
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/v17.12/compose/compose-file/index.md"
               data-name="v17.12"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                v17.12
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/vnext-compose/compose/compose-file/index.md"
               data-name="vnext-compose"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                vnext-compose
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/vnext-distribution/compose/compose-file/index.md"
               data-name="vnext-distribution"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                vnext-distribution
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/vnext-engine/compose/compose-file/index.md"
               data-name="vnext-engine"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                vnext-engine
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/vnext-machine/compose/compose-file/index.md"
               data-name="vnext-machine"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                vnext-machine
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/vnext-swarm/compose/compose-file/index.md"
               data-name="vnext-swarm"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                vnext-swarm
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/docker/docker.github.io/blob/vnext-toolbox/compose/compose-file/index.md"
               data-name="vnext-toolbox"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                vnext-toolbox
              </span>
            </a>
        </div>

          <div class="select-menu-no-results">Nothing to show</div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="tags">
        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


            <a class="select-menu-item js-navigation-item js-navigation-open "
              href="/docker/docker.github.io/tree/v17.09-release/compose/compose-file/index.md"
              data-name="v17.09-release"
              data-skip-pjax="true"
              rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target" title="v17.09-release">
                v17.09-release
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
              href="/docker/docker.github.io/tree/v17.06-release/compose/compose-file/index.md"
              data-name="v17.06-release"
              data-skip-pjax="true"
              rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target" title="v17.06-release">
                v17.06-release
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
              href="/docker/docker.github.io/tree/v17.03-release/compose/compose-file/index.md"
              data-name="v17.03-release"
              data-skip-pjax="true"
              rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target" title="v17.03-release">
                v17.03-release
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
              href="/docker/docker.github.io/tree/v1.13-release/compose/compose-file/index.md"
              data-name="v1.13-release"
              data-skip-pjax="true"
              rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target" title="v1.13-release">
                v1.13-release
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
              href="/docker/docker.github.io/tree/v1.12-release/compose/compose-file/index.md"
              data-name="v1.12-release"
              data-skip-pjax="true"
              rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target" title="v1.12-release">
                v1.12-release
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
              href="/docker/docker.github.io/tree/ucp2.1.0-dtr2.2.0/compose/compose-file/index.md"
              data-name="ucp2.1.0-dtr2.2.0"
              data-skip-pjax="true"
              rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target" title="ucp2.1.0-dtr2.2.0">
                ucp2.1.0-dtr2.2.0
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
              href="/docker/docker.github.io/tree/ucp2.0.1-dtr2.1.0/compose/compose-file/index.md"
              data-name="ucp2.0.1-dtr2.1.0"
              data-skip-pjax="true"
              rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target" title="ucp2.0.1-dtr2.1.0">
                ucp2.0.1-dtr2.1.0
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
              href="/docker/docker.github.io/tree/17.06-stable/compose/compose-file/index.md"
              data-name="17.06-stable"
              data-skip-pjax="true"
              rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target" title="17.06-stable">
                17.06-stable
              </span>
            </a>
        </div>

        <div class="select-menu-no-results">Nothing to show</div>
      </div>

    </div>
  </div>
</div>

    <div class="BtnGroup float-right">
      <a href="/docker/docker.github.io/find/master"
            class="js-pjax-capture-input btn btn-sm BtnGroup-item"
            data-pjax
            data-hotkey="t">
        Find file
      </a>
      <clipboard-copy for="blob-path" class="btn btn-sm BtnGroup-item">
        Copy path
      </clipboard-copy>
    </div>
    <div id="blob-path" class="breadcrumb">
      <span class="repo-root js-repo-root"><span class="js-path-segment"><a data-pjax="true" href="/docker/docker.github.io"><span>docker.github.io</span></a></span></span><span class="separator">/</span><span class="js-path-segment"><a data-pjax="true" href="/docker/docker.github.io/tree/master/compose"><span>compose</span></a></span><span class="separator">/</span><span class="js-path-segment"><a data-pjax="true" href="/docker/docker.github.io/tree/master/compose/compose-file"><span>compose-file</span></a></span><span class="separator">/</span><strong class="final-path">index.md</strong>
    </div>
  </div>


  <include-fragment src="/docker/docker.github.io/contributors/master/compose/compose-file/index.md" class="commit-tease">
    <div>
      Fetching contributors&hellip;
    </div>

    <div class="commit-tease-contributors">
      <img alt="" class="loader-loading float-left" src="https://assets-cdn.github.com/images/spinners/octocat-spinner-32-EAF2F5.gif" width="16" height="16" />
      <span class="loader-error">Cannot retrieve contributors at this time</span>
    </div>
</include-fragment>


  <div class="file">
    <div class="file-header">
  <div class="file-actions">

    <div class="BtnGroup">
      <a id="raw-url" class="btn btn-sm BtnGroup-item" href="/docker/docker.github.io/raw/master/compose/compose-file/index.md">Raw</a>
        <a class="btn btn-sm js-update-url-with-hash BtnGroup-item" data-hotkey="b" href="/docker/docker.github.io/blame/master/compose/compose-file/index.md">Blame</a>
      <a rel="nofollow" class="btn btn-sm BtnGroup-item" href="/docker/docker.github.io/commits/master/compose/compose-file/index.md">History</a>
    </div>


        <button type="button" class="btn-octicon disabled tooltipped tooltipped-nw"
          aria-label="You must be signed in to make or propose changes">
          <svg class="octicon octicon-pencil" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"/></svg>
        </button>
        <button type="button" class="btn-octicon btn-octicon-danger disabled tooltipped tooltipped-nw"
          aria-label="You must be signed in to make or propose changes">
          <svg class="octicon octicon-trashcan" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"/></svg>
        </button>
  </div>

  <div class="file-info">
      2343 lines (1779 sloc)
      <span class="file-info-divider"></span>
    69.2 KB
  </div>
</div>

    
  <div id="readme" class="readme blob instapaper_body">
    <article class="markdown-body entry-content" itemprop="text"><table data-table-type="yaml-metadata">
  <thead>
  <tr>
  <th>description</th>
  <th>keywords</th>
  <th>redirect_from</th>
  <th>title</th>
  <th>toc_max</th>
  <th>toc_min</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>Compose file reference</div></td>
  <td><div>fig, composition, compose, docker</div></td>
  <td><div><table>
  <tbody>
  <tr>
  <td><div>/compose/yml</div></td>
  <td><div>/compose/compose-file-v3.md</div></td>
  </tr>
  </tbody>
</table>
</div></td>
  <td><div>Compose file version 3 reference</div></td>
  <td><div>4</div></td>
  <td><div>1</div></td>
  </tr>
  </tbody>
</table>

<h2><a id="user-content-reference-and-guidelines" class="anchor" aria-hidden="true" href="#reference-and-guidelines"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reference and guidelines</h2>
<p>These topics describe version 3 of the Compose file format. This is the newest
version.</p>
<h2><a id="user-content-compose-and-docker-compatibility-matrix" class="anchor" aria-hidden="true" href="#compose-and-docker-compatibility-matrix"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Compose and Docker compatibility matrix</h2>
<p>There are several versions of the Compose file format – 1, 2, 2.x, and 3.x. The
table below is a quick look. For full details on what each version includes and
how to upgrade, see <strong><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md">About versions and upgrading</a></strong>.</p>
<p>{% include content/compose-matrix.md %}</p>
<h2><a id="user-content-compose-file-structure-and-examples" class="anchor" aria-hidden="true" href="#compose-file-structure-and-examples"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Compose file structure and examples</h2>
<div>
    <div>
    Example Compose file version 3
    <i></i></div>
    <div id="user-content-collapseSample1">
<pre><code>
version: "3"
services:
<p>redis:
image: redis:alpine
ports:
- "6379"
networks:
- frontend
deploy:
replicas: 2
update_config:
parallelism: 2
delay: 10s
restart_policy:
condition: on-failure</p>
<p>db:
image: postgres:9.4
volumes:
- db-data:/var/lib/postgresql/data
networks:
- backend
deploy:
placement:
constraints: [node.role == manager]</p>
<p>vote:
image: dockersamples/examplevotingapp_vote:before
ports:
- "5000:80"
networks:
- frontend
depends_on:
- redis
deploy:
replicas: 2
update_config:
parallelism: 2
restart_policy:
condition: on-failure</p>
<p>result:
image: dockersamples/examplevotingapp_result:before
ports:
- "5001:80"
networks:
- backend
depends_on:
- db
deploy:
replicas: 1
update_config:
parallelism: 2
delay: 10s
restart_policy:
condition: on-failure</p>
<p>worker:
image: dockersamples/examplevotingapp_worker
networks:
- frontend
- backend
deploy:
mode: replicated
replicas: 1
labels: [APP=VOTING]
restart_policy:
condition: on-failure
delay: 10s
max_attempts: 3
window: 120s
placement:
constraints: [node.role == manager]</p>
<p>visualizer:
image: dockersamples/visualizer:stable
ports:
- "8080:8080"
stop_grace_period: 1m30s
volumes:
- "/var/run/docker.sock:/var/run/docker.sock"
deploy:
placement:
constraints: [node.role == manager]</p>
<p>networks:
frontend:
backend:</p>
</code><p><code>volumes:
db-data:
</code></p></pre>
</div><p></p>
</div>
<p>The topics on this reference page are organized alphabetically by top-level key
to reflect the structure of the Compose file itself. Top-level keys that define
a section in the configuration file such as <code>build</code>, <code>deploy</code>, <code>depends_on</code>,
<code>networks</code>, and so on, are listed with the options that support them as
sub-topics. This maps to the <code>&lt;key&gt;: &lt;option&gt;: &lt;value&gt;</code> indent structure of the
Compose file.</p>
<p>A good place to start is the <a href="/docker/docker.github.io/blob/master/get-started/index.md">Getting Started</a> tutorial
which uses version 3 Compose stack files to implement multi-container apps,
service definitions, and swarm mode. Here are some Compose files used in the
tutorial.</p>
<ul>
<li>
<p><a href="/docker/docker.github.io/blob/master/get-started/part3.md#your-first-docker-composeyml-file">Your first docker-compose.yml File</a></p>
</li>
<li>
<p><a href="/docker/docker.github.io/blob/master/get-started/part5.md#add-a-new-service-and-redeploy">Add a new service and redeploy</a></p>
</li>
</ul>
<p>Another good reference is the Compose file for the voting app sample used in the
<a href="https://github.com/docker/labs/tree/master/beginner/">Docker for Beginners lab</a>
topic on <a href="https://github.com/docker/labs/blob/master/beginner/chapters/votingapp.md">Deploying an app to a
Swarm</a>. This is also shown on the accordion at the top of this section.</p>
<h2><a id="user-content-service-configuration-reference" class="anchor" aria-hidden="true" href="#service-configuration-reference"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Service configuration reference</h2>
<p>The Compose file is a <a href="http://yaml.org/" rel="nofollow">YAML</a> file defining
<a href="#service-configuration-reference">services</a>,
<a href="#network-configuration-reference">networks</a> and
<a href="#volume-configuration-reference">volumes</a>.
The default path for a Compose file is <code>./docker-compose.yml</code>.</p>
<blockquote>
<p><strong>Tip</strong>: You can use either a <code>.yml</code> or <code>.yaml</code> extension for this file.
They both work.</p>
</blockquote>
<p>A service definition contains configuration that is applied to each
container started for that service, much like passing command-line parameters to
<code>docker container create</code>. Likewise, network and volume definitions are analogous to
<code>docker network create</code> and <code>docker volume create</code>.</p>
<p>As with <code>docker container create</code>, options specified in the Dockerfile, such as <code>CMD</code>,
<code>EXPOSE</code>, <code>VOLUME</code>, <code>ENV</code>, are respected by default - you don't need to
specify them again in <code>docker-compose.yml</code>.</p>
<p>You can use environment variables in configuration values with a Bash-like
<code>${VARIABLE}</code> syntax - see
<a href="#variable-substitution">variable substitution</a> for full details.</p>
<p>This section contains a list of all configuration options supported by a service
definition in version 3.</p>
<h3><a id="user-content-build" class="anchor" aria-hidden="true" href="#build"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>build</h3>
<p>Configuration options that are applied at build time.</p>
<p><code>build</code> can be specified either as a string containing a path to the build
context:</p>
<pre lang="none"><code>version: '3'
services:
  webapp:
    build: ./dir
</code></pre>
<p>Or, as an object with the path specified under <a href="#context">context</a> and
optionally <a href="#dockerfile">Dockerfile</a> and <a href="#args">args</a>:</p>
<pre lang="none"><code>version: '3'
services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
</code></pre>
<p>If you specify <code>image</code> as well as <code>build</code>, then Compose names the built image
with the <code>webapp</code> and optional <code>tag</code> specified in <code>image</code>:</p>
<pre><code>build: ./dir
image: webapp:tag
</code></pre>
<p>This results in an image named <code>webapp</code> and tagged <code>tag</code>, built from <code>./dir</code>.</p>
<blockquote>
<p><strong>Note</strong>: This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file. The <code>docker stack</code> command accepts only pre-built images.</p>
</blockquote>
<h4><a id="user-content-context" class="anchor" aria-hidden="true" href="#context"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>context</h4>
<p>Either a path to a directory containing a Dockerfile, or a url to a git repository.</p>
<p>When the value supplied is a relative path, it is interpreted as relative to the
location of the Compose file. This directory is also the build context that is
sent to the Docker daemon.</p>
<p>Compose builds and tags it with a generated name, and use that image
thereafter.</p>
<pre><code>build:
  context: ./dir
</code></pre>
<h4><a id="user-content-dockerfile" class="anchor" aria-hidden="true" href="#dockerfile"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>dockerfile</h4>
<p>Alternate Dockerfile.</p>
<p>Compose uses an alternate file to build with. A build path must also be
specified.</p>
<pre><code>build:
  context: .
  dockerfile: Dockerfile-alternate
</code></pre>
<h4><a id="user-content-args" class="anchor" aria-hidden="true" href="#args"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>args</h4>
<p>Add build arguments, which are environment variables accessible only during the
build process.</p>
<p>First, specify the arguments in your Dockerfile:</p>
<pre><code>ARG buildno
ARG gitcommithash

RUN echo "Build number: $buildno"
RUN echo "Based on commit: $gitcommithash"
</code></pre>
<p>Then specify the arguments under the <code>build</code> key. You can pass a mapping
or a list:</p>
<pre><code>build:
  context: .
  args:
    buildno: 1
    gitcommithash: cdc3b19

build:
  context: .
  args:
    - buildno=1
    - gitcommithash=cdc3b19
</code></pre>
<p>You can omit the value when specifying a build argument, in which case its value
at build time is the value in the environment where Compose is running.</p>
<pre><code>args:
  - buildno
  - gitcommithash
</code></pre>
<blockquote>
<p><strong>Note</strong>: YAML boolean values (<code>true</code>, <code>false</code>, <code>yes</code>, <code>no</code>, <code>on</code>, <code>off</code>) must
be enclosed in quotes, so that the parser interprets them as strings.</p>
</blockquote>
<h4><a id="user-content-cache_from" class="anchor" aria-hidden="true" href="#cache_from"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cache_from</h4>
<blockquote>
<p><strong>Note:</strong> This option is new in v3.2</p>
</blockquote>
<p>A list of images that the engine uses for cache resolution.</p>
<pre><code>build:
  context: .
  cache_from:
    - alpine:latest
    - corp/web_app:3.14
</code></pre>
<h4><a id="user-content-labels" class="anchor" aria-hidden="true" href="#labels"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>labels</h4>
<blockquote>
<p><strong>Note:</strong> This option is new in v3.3</p>
</blockquote>
<p>Add metadata to the resulting image using <a href="/docker/docker.github.io/blob/master/engine/userguide/labels-custom-metadata.md">Docker labels</a>.
You can use either an array or a dictionary.</p>
<p>It's recommended that you use reverse-DNS notation to prevent your labels from conflicting with
those used by other software.</p>
<pre><code>build:
  context: .
  labels:
    com.example.description: "Accounting webapp"
    com.example.department: "Finance"
    com.example.label-with-empty-value: ""


build:
  context: .
  labels:
    - "com.example.description=Accounting webapp"
    - "com.example.department=Finance"
    - "com.example.label-with-empty-value"
</code></pre>
<h4><a id="user-content-shm_size" class="anchor" aria-hidden="true" href="#shm_size"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>shm_size</h4>
<blockquote>
<p>Added in <a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-35">version 3.5</a> file format</p>
</blockquote>
<p>Set the size of the <code>/dev/shm</code> partition for this build's containers. Specify
as an integer value representing the number of bytes or as a string expressing
a <a href="#specifying-byte-values">byte value</a>.</p>
<pre><code>build:
  context: .
  shm_size: '2gb'


build:
  context: .
  shm_size: 10000000
</code></pre>
<h4><a id="user-content-target" class="anchor" aria-hidden="true" href="#target"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>target</h4>
<blockquote>
<p>Added in <a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-34">version 3.4</a> file format</p>
</blockquote>
<p>Build the specified stage as defined inside the <code>Dockerfile</code>. See the
<a href="/docker/docker.github.io/blob/master/engine/userguide/eng-image/multistage-build.md">multi-stage build docs</a> for
details.</p>
<pre><code>  build:
    context: .
    target: prod
</code></pre>
<h3><a id="user-content-cap_add-cap_drop" class="anchor" aria-hidden="true" href="#cap_add-cap_drop"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cap_add, cap_drop</h3>
<p>Add or drop container capabilities.
See <code>man 7 capabilities</code> for a full list.</p>
<pre><code>cap_add:
  - ALL

cap_drop:
  - NET_ADMIN
  - SYS_ADMIN
</code></pre>
<blockquote>
<p><strong>Note</strong>: These options are ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file.</p>
</blockquote>
<h3><a id="user-content-command" class="anchor" aria-hidden="true" href="#command"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>command</h3>
<p>Override the default command.</p>
<pre><code>command: bundle exec thin -p 3000
</code></pre>
<p>The command can also be a list, in a manner similar to
<a href="/docker/docker.github.io/blob/master/engine/reference/builder.md#cmd">dockerfile</a>:</p>
<pre><code>command: ["bundle", "exec", "thin", "-p", "3000"]
</code></pre>
<h3><a id="user-content-configs" class="anchor" aria-hidden="true" href="#configs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>configs</h3>
<p>Grant access to configs on a per-service basis using the per-service <code>configs</code>
configuration. Two different syntax variants are supported.</p>
<blockquote>
<p><strong>Note</strong>: The config must already exist or be
<a href="#configs-configuration-reference">defined in the top-level <code>configs</code> configuration</a>
of this stack file, or stack deployment fails.</p>
</blockquote>
<p>For more information on configs, see <a href="/docker/docker.github.io/blob/master/engine/swarm/configs.md">configs</a>.</p>
<h4><a id="user-content-short-syntax" class="anchor" aria-hidden="true" href="#short-syntax"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Short syntax</h4>
<p>The short syntax variant only specifies the config name. This grants the
container access to the config and mounts it at <code>/&lt;config_name&gt;</code>
within the container. The source name and destination mountpoint are both set
to the config name.</p>
<p>The following example uses the short syntax to grant the <code>redis</code> service
access to the <code>my_config</code> and <code>my_other_config</code> configs. The value of
<code>my_config</code> is set to the contents of the file <code>./my_config.txt</code>, and
<code>my_other_config</code> is defined as an external resource, which means that it has
already been defined in Docker, either by running the <code>docker config create</code>
command or by another stack deployment. If the external config does not exist,
the stack deployment fails with a <code>config not found</code> error.</p>
<blockquote>
<p><strong>Note</strong>: <code>config</code> definitions are only supported in version 3.3 and higher
of the compose file format.</p>
</blockquote>
<pre lang="none"><code>version: "3.3"
services:
  redis:
    image: redis:latest
    deploy:
      replicas: 1
    configs:
      - my_config
      - my_other_config
configs:
  my_config:
    file: ./my_config.txt
  my_other_config:
    external: true
</code></pre>
<h4><a id="user-content-long-syntax" class="anchor" aria-hidden="true" href="#long-syntax"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Long syntax</h4>
<p>The long syntax provides more granularity in how the config is created within
the service's task containers.</p>
<ul>
<li><code>source</code>: The name of the config as it exists in Docker.</li>
<li><code>target</code>: The path and name of the file to be mounted in the service's
task containers. Defaults to <code>/&lt;source&gt;</code> if not specified.</li>
<li><code>uid</code> and <code>gid</code>: The numeric UID or GID that owns the mounted config file
within in the service's task containers. Both default to <code>0</code> on Linux if not
specified. Not supported on Windows.</li>
<li><code>mode</code>: The permissions for the file that is mounted within the service's
task containers, in octal notation. For instance, <code>0444</code>
represents world-readable. The default is <code>0444</code>. Configs cannot be writable
because they are mounted in a temporary filesystem, so if you set the writable
bit, it is ignored. The executable bit can be set. If you aren't familiar with
UNIX file permission modes, you may find this
<a href="http://permissions-calculator.org/" rel="nofollow">permissions calculator</a>{: target="<em>blank" class="</em>" }
useful.</li>
</ul>
<p>The following example sets the name of <code>my_config</code> to <code>redis_config</code> within the
container, sets the mode to <code>0440</code> (group-readable) and sets the user and group
to <code>103</code>. The <code>redis</code> service does not have access to the <code>my_other_config</code>
config.</p>
<pre lang="none"><code>version: "3.3"
services:
  redis:
    image: redis:latest
    deploy:
      replicas: 1
    configs:
      - source: my_config
        target: /redis_config
        uid: '103'
        gid: '103'
        mode: 0440
configs:
  my_config:
    file: ./my_config.txt
  my_other_config:
    external: true
</code></pre>
<p>You can grant a service access to multiple configs and you can mix long and
short syntax. Defining a config does not imply granting a service access to it.</p>
<h3><a id="user-content-cgroup_parent" class="anchor" aria-hidden="true" href="#cgroup_parent"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cgroup_parent</h3>
<p>Specify an optional parent cgroup for the container.</p>
<pre><code>cgroup_parent: m-executor-abcd
</code></pre>
<blockquote>
<p><strong>Note</strong>: This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file.</p>
</blockquote>
<h3><a id="user-content-container_name" class="anchor" aria-hidden="true" href="#container_name"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>container_name</h3>
<p>Specify a custom container name, rather than a generated default name.</p>
<pre><code>container_name: my-web-container
</code></pre>
<p>Because Docker container names must be unique, you cannot scale a service beyond
1 container if you have specified a custom name. Attempting to do so results in
an error.</p>
<blockquote>
<p><strong>Note</strong>: This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file.</p>
</blockquote>
<h3><a id="user-content-credential_spec" class="anchor" aria-hidden="true" href="#credential_spec"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>credential_spec</h3>
<blockquote>
<p><strong>Note:</strong> this option was added in v3.3</p>
</blockquote>
<p>Configure the credential spec for managed service account. This option is only
used for services using Windows containers. The <code>credential_spec</code> must be in the
format <code>file://&lt;filename&gt;</code> or <code>registry://&lt;value-name&gt;</code>.</p>
<p>When using <code>file:</code>, the referenced file must be present in the <code>CredentialSpecs</code>
subdirectory in the docker data directory, which defaults to <code>C:\ProgramData\Docker\</code>
on Windows. The following example loads the credential spec from a file named
<code>C:\ProgramData\Docker\CredentialSpecs\my-credential-spec.json</code>:</p>
<pre><code>credential_spec:
  file: my-credential-spec.json
</code></pre>
<p>When using <code>registry:</code>, the credential spec is read from the Windows registry on
the daemon's host. A registry value with the given name must be located in:</p>
<pre><code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Virtualization\Containers\CredentialSpecs
</code></pre>
<p>The following example load the credential spec from a value named <code>my-credential-spec</code>
in the registry:</p>
<pre><code>credential_spec:
  registry: my-credential-spec
</code></pre>
<h3><a id="user-content-deploy" class="anchor" aria-hidden="true" href="#deploy"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>deploy</h3>
<blockquote>
<p><strong><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-3">Version 3</a> only.</strong></p>
</blockquote>
<p>Specify configuration related to the deployment and running of services. This
only takes effect when deploying to a <a href="/docker/docker.github.io/blob/master/engine/swarm/index.md">swarm</a> with
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">docker stack deploy</a>, and is
ignored by <code>docker-compose up</code> and <code>docker-compose run</code>.</p>
<pre><code>version: '3'
services:
  redis:
    image: redis:alpine
    deploy:
      replicas: 6
      update_config:
        parallelism: 2
        delay: 10s
      restart_policy:
        condition: on-failure
</code></pre>
<p>Several sub-options are available:</p>
<h4><a id="user-content-endpoint_mode" class="anchor" aria-hidden="true" href="#endpoint_mode"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>endpoint_mode</h4>
<p>Specify a service discovery method for external clients connecting to a swarm.</p>
<blockquote>
<p><strong><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-3">Version 3.3</a> only.</strong></p>
</blockquote>
<ul>
<li>
<p><code>endpoint_mode: vip</code> - Docker assigns the service a virtual IP (VIP)
that acts as the “front end” for clients to reach the service on a
network. Docker routes requests between the client and available worker
nodes for the service, without client knowledge of how many nodes
are participating in the service or their IP addresses or ports.
(This is the default.)</p>
</li>
<li>
<p><code>endpoint_mode: dnsrr</code> -  DNS round-robin (DNSRR) service discovery does
not use a single virtual IP. Docker sets up DNS entries for the service
such that a DNS query for the service name returns a list of IP addresses,
and the client connects directly to one of these. DNS round-robin is useful
in cases where you want to use your own load balancer, or for Hybrid
Windows and Linux applications.</p>
</li>
</ul>
<pre lang="none"><code>version: "3.3"

services:
  wordpress:
    image: wordpress
    ports:
      - "8080:80"
    networks:
      - overlay
    deploy:
      mode: replicated
      replicas: 2
      endpoint_mode: vip

  mysql:
    image: mysql
    volumes:
       - db-data:/var/lib/mysql/data
    networks:
       - overlay
    deploy:
      mode: replicated
      replicas: 2
      endpoint_mode: dnsrr

volumes:
  db-data:

networks:
  overlay:
</code></pre>
<p>The options for <code>endpoint_mode</code> also work as flags on the swarm mode CLI command
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/service_create.md">docker service create</a>. For a
quick list of all swarm related <code>docker</code> commands, see <a href="/docker/docker.github.io/blob/master/engine/swarm.md#swarm-mode-key-concepts-and-tutorial">Swarm mode CLI
commands</a>.</p>
<p>To learn more about service discovery and networking in swarm mode, see
<a href="/docker/docker.github.io/blob/master/engine/swarm/networking.md#configure-service-discovery">Configure service
discovery</a> in the swarm
mode topics.</p>
<h4><a id="user-content-labels-1" class="anchor" aria-hidden="true" href="#labels-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>labels</h4>
<p>Specify labels for the service. These labels are <em>only</em> set on the service,
and <em>not</em> on any containers for the service.</p>
<pre><code>version: "3"
services:
  web:
    image: web
    deploy:
      labels:
        com.example.description: "This label will appear on the web service"
</code></pre>
<p>To set labels on containers instead, use the <code>labels</code> key outside of <code>deploy</code>:</p>
<pre><code>version: "3"
services:
  web:
    image: web
    labels:
      com.example.description: "This label will appear on all containers for the web service"
</code></pre>
<h4><a id="user-content-mode" class="anchor" aria-hidden="true" href="#mode"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>mode</h4>
<p>Either <code>global</code> (exactly one container per swarm node) or <code>replicated</code> (a
specified number of containers). The default is <code>replicated</code>. (To learn more,
see <a href="/docker/docker.github.io/blob/master/engine/swarm/how-swarm-mode-works/services/#replicated-and-global-services">Replicated and global
services</a>
in the <a href="/docker/docker.github.io/blob/master/engine/swarm">swarm</a> topics.)</p>
<pre><code>version: '3'
services:
  worker:
    image: dockersamples/examplevotingapp_worker
    deploy:
      mode: global
</code></pre>
<h4><a id="user-content-placement" class="anchor" aria-hidden="true" href="#placement"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>placement</h4>
<p>Specify placement of constraints and preferences. See the docker service create documentation for a full description of the syntax and available types of <a href="/docker/docker.github.io/blob/master/engine/reference/commandline/service_create.md#specify-service-constraints-constraint">constraints</a> and <a href="/docker/docker.github.io/blob/master/engine/reference/commandline/service_create.md#specify-service-placement-preferences-placement-pref">preferences</a>.</p>
<pre><code>version: '3.3'
services:
  db:
    image: postgres
    deploy:
      placement:
        constraints:
          - node.role == manager
          - engine.labels.operatingsystem == ubuntu 14.04
        preferences:
          - spread: node.labels.zone
</code></pre>
<h4><a id="user-content-replicas" class="anchor" aria-hidden="true" href="#replicas"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>replicas</h4>
<p>If the service is <code>replicated</code> (which is the default), specify the number of
containers that should be running at any given time.</p>
<pre><code>version: '3'
services:
  worker:
    image: dockersamples/examplevotingapp_worker
    networks:
      - frontend
      - backend
    deploy:
      mode: replicated
      replicas: 6
</code></pre>
<h4><a id="user-content-resources" class="anchor" aria-hidden="true" href="#resources"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>resources</h4>
<p>Configures resource constraints.</p>
<blockquote>
<p><strong>Note</strong>: This replaces the <a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-file-v2.md#cpu-and-other-resources">older resource constraint options</a> for non swarm mode in
Compose files prior to version 3 (<code>cpu_shares</code>, <code>cpu_quota</code>, <code>cpuset</code>,
<code>mem_limit</code>, <code>memswap_limit</code>, <code>mem_swappiness</code>), as described in <a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#upgrading">Upgrading
version 2.x to 3.x</a>.</p>
</blockquote>
<p>Each of these is a single value, analogous to its <a href="/docker/docker.github.io/blob/master/engine/reference/commandline/service_create.md">docker service
create</a> counterpart.</p>
<p>In this general example, the <code>redis</code> service is constrained to use no more than
50M of memory and <code>0.50</code> (50%) of available processing time (CPU), and has
<code>20M</code> of memory and <code>0.25</code> CPU time reserved (as always available to it).</p>
<pre lang="none"><code>version: '3'
services:
  redis:
    image: redis:alpine
    deploy:
      resources:
        limits:
          cpus: '0.50'
          memory: 50M
        reservations:
          cpus: '0.25'
          memory: 20M
</code></pre>
<p>The topics below describe available options to set resource constraints on
services or containers in a swarm.</p>
<blockquote>
<p>Looking for options to set resources on non swarm mode containers?</p>
<p>The options described here are specific to the
<code>deploy</code> key and swarm mode. If you want to set resource constraints
on non swarm deployments, use
<a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-file-v2.md#cpu-and-other-resources">Compose file format version 2 CPU, memory, and other resource
options</a>.
If you have further questions, refer to the discussion on the GitHub
issue <a href="https://github.com/docker/compose/issues/4513">docker/compose/4513</a>{: target="<em>blank" class="</em>"}.
{: .important}</p>
</blockquote>
<h5><a id="user-content-out-of-memory-exceptions-oome" class="anchor" aria-hidden="true" href="#out-of-memory-exceptions-oome"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Out Of Memory Exceptions (OOME)</h5>
<p>If your services or containers attempt to use more memory than the system has
available, you may experience an Out Of Memory Exception (OOME) and a container,
or the Docker daemon, might be killed by the kernel OOM killer. To prevent this
from happening, ensure that your application runs on hosts with adequate memory
and see <a href="/docker/docker.github.io/blob/master/engine/admin/resource_constraints.md#understand-the-risks-of-running-out-of-memory">Understand the risks of running out of
memory</a>.</p>
<h4><a id="user-content-restart_policy" class="anchor" aria-hidden="true" href="#restart_policy"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>restart_policy</h4>
<p>Configures if and how to restart containers when they exit. Replaces
<a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-file-v2.md#orig-resources"><code>restart</code></a>.</p>
<ul>
<li><code>condition</code>: One of <code>none</code>, <code>on-failure</code> or <code>any</code> (default: <code>any</code>).</li>
<li><code>delay</code>: How long to wait between restart attempts, specified as a
<a href="#specifying-durations">duration</a> (default: 0).</li>
<li><code>max_attempts</code>: How many times to attempt to restart a container before giving
up (default: never give up). If the restart does not succeed within the configured
<code>window</code>, this attempt doesn't count toward the configured <code>max_attempts</code> value.
For example, if <code>max_attempts</code> is set to '2', and the restart fails on the first
attempt, more than two restarts may be attempted.</li>
<li><code>window</code>: How long to wait before deciding if a restart has succeeded,
specified as a <a href="#specifying-durations">duration</a> (default:
decide immediately).</li>
</ul>
<pre lang="none"><code>version: "3"
services:
  redis:
    image: redis:alpine
    deploy:
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3
        window: 120s
</code></pre>
<h4><a id="user-content-update_config" class="anchor" aria-hidden="true" href="#update_config"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>update_config</h4>
<p>Configures how the service should be updated. Useful for configuring rolling
updates.</p>
<ul>
<li><code>parallelism</code>: The number of containers to update at a time.</li>
<li><code>delay</code>: The time to wait between updating a group of containers.</li>
<li><code>failure_action</code>: What to do if an update fails. One of <code>continue</code>, <code>rollback</code>, or <code>pause</code>
(default: <code>pause</code>).</li>
<li><code>monitor</code>: Duration after each task update to monitor for failure <code>(ns|us|ms|s|m|h)</code> (default 0s).</li>
<li><code>max_failure_ratio</code>: Failure rate to tolerate during an update.</li>
<li><code>order</code>: Order of operations during updates. One of <code>stop-first</code> (old task is stopped before starting new one), or <code>start-first</code> (new task is started first, and the running tasks briefly overlap) (default <code>stop-first</code>) <strong>Note</strong>: Only supported for v3.4 and higher.</li>
</ul>
<blockquote>
<p><strong>Note</strong>: <code>order</code> is only supported for v3.4 and higher of the compose
file format.</p>
</blockquote>
<pre lang="none"><code>version: '3.4'
services:
  vote:
    image: dockersamples/examplevotingapp_vote:before
    depends_on:
      - redis
    deploy:
      replicas: 2
      update_config:
        parallelism: 2
        delay: 10s
        order: stop-first
</code></pre>
<h4><a id="user-content-not-supported-for-docker-stack-deploy" class="anchor" aria-hidden="true" href="#not-supported-for-docker-stack-deploy"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Not supported for <code>docker stack deploy</code></h4>
<p>The following sub-options (supported for <code>docker-compose up</code> and <code>docker-compose run</code>) are <em>not supported</em> for <code>docker stack deploy</code> or the <code>deploy</code> key.</p>
<ul>
<li><a href="#build">build</a></li>
<li><a href="#cgroup_parent">cgroup_parent</a></li>
<li><a href="#container_name">container_name</a></li>
<li><a href="#devices">devices</a></li>
<li><a href="#tmpfs">tmpfs</a></li>
<li><a href="#external_links">external_links</a></li>
<li><a href="#links">links</a></li>
<li><a href="#network_mode">network_mode</a></li>
<li><a href="#restart">restart</a></li>
<li><a href="#security_opt">security_opt</a></li>
<li><a href="#stop_signal">stop_signal</a></li>
<li><a href="#sysctls">sysctls</a></li>
<li><a href="#userns_mode">userns_mode</a></li>
</ul>
<blockquote>
<p><strong>Tip:</strong> See the section on <a href="#volumes-for-services-swarms-and-stack-files">how to configure volumes
for services, swarms, and docker-stack.yml
files</a>. Volumes <em>are</em> supported
but to work with swarms and services, they must be configured
as named volumes or associated with services that are constrained to nodes with
access to the requisite volumes.</p>
</blockquote>
<h3><a id="user-content-devices" class="anchor" aria-hidden="true" href="#devices"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>devices</h3>
<p>List of device mappings.  Uses the same format as the <code>--device</code> docker
client create option.</p>
<pre><code>devices:
  - "/dev/ttyUSB0:/dev/ttyUSB0"
</code></pre>
<blockquote>
<p><strong>Note</strong>: This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file.</p>
</blockquote>
<h3><a id="user-content-depends_on" class="anchor" aria-hidden="true" href="#depends_on"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>depends_on</h3>
<p>Express dependency between services, Service dependencies cause the following
behaviors:</p>
<ul>
<li>
<p><code>docker-compose up</code> starts services in dependency order. In the following
example, <code>db</code> and <code>redis</code> are started before <code>web</code>.</p>
</li>
<li>
<p><code>docker-compose up SERVICE</code> automatically includes <code>SERVICE</code>'s
dependencies. In the following example, <code>docker-compose up web</code> also
creates and starts <code>db</code> and <code>redis</code>.</p>
</li>
</ul>
<p>Simple example:</p>
<pre><code>version: '3'
services:
  web:
    build: .
    depends_on:
      - db
      - redis
  redis:
    image: redis
  db:
    image: postgres
</code></pre>
<blockquote>
<p>There are several things to be aware of when using <code>depends_on</code>:</p>
<ul>
<li>
<p><code>depends_on</code> does not wait for <code>db</code> and <code>redis</code> to be "ready" before
starting <code>web</code> - only until they have been started. If you need to wait
for a service to be ready, see <a href="/docker/docker.github.io/blob/master/compose/startup-order.md">Controlling startup order</a>
for more on this problem and strategies for solving it.</p>
</li>
<li>
<p>Version 3 no longer supports the <code>condition</code> form of <code>depends_on</code>.</p>
</li>
<li>
<p>The <code>depends_on</code> option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a version 3 Compose file.</p>
</li>
</ul>
</blockquote>
<h3><a id="user-content-dns" class="anchor" aria-hidden="true" href="#dns"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>dns</h3>
<p>Custom DNS servers. Can be a single value or a list.</p>
<pre><code>dns: 8.8.8.8
dns:
  - 8.8.8.8
  - 9.9.9.9
</code></pre>
<h3><a id="user-content-dns_search" class="anchor" aria-hidden="true" href="#dns_search"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>dns_search</h3>
<p>Custom DNS search domains. Can be a single value or a list.</p>
<pre><code>dns_search: example.com
dns_search:
  - dc1.example.com
  - dc2.example.com
</code></pre>
<h3><a id="user-content-tmpfs" class="anchor" aria-hidden="true" href="#tmpfs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>tmpfs</h3>
<blockquote>
<p><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-2">Version 2 file format</a> and up.</p>
</blockquote>
<p>Mount a temporary file system inside the container. Can be a single value or a list.</p>
<pre><code>tmpfs: /run
tmpfs:
  - /run
  - /tmp
</code></pre>
<blockquote>
<p><strong>Note</strong>: This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3-3.5) Compose file.</p>
</blockquote>
<blockquote>
<p><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-3">Version 3.6 file format</a> and up.</p>
</blockquote>
<p>Mount a temporary file system inside the container. Size parameter specifies the size
of the tmpfs mount in bytes. Unlimited by default.</p>
<pre><code> - type: tmpfs
     target: /app
     tmpfs:
       size: 1000
</code></pre>
<h3><a id="user-content-entrypoint" class="anchor" aria-hidden="true" href="#entrypoint"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>entrypoint</h3>
<p>Override the default entrypoint.</p>
<pre><code>entrypoint: /code/entrypoint.sh
</code></pre>
<p>The entrypoint can also be a list, in a manner similar to
<a href="/docker/docker.github.io/blob/master/engine/reference/builder.md#entrypoint">dockerfile</a>:</p>
<pre><code>entrypoint:
    - php
    - -d
    - zend_extension=/usr/local/lib/php/extensions/no-debug-non-zts-20100525/xdebug.so
    - -d
    - memory_limit=-1
    - vendor/bin/phpunit
</code></pre>
<blockquote>
<p><strong>Note</strong>: Setting <code>entrypoint</code> both overrides any default entrypoint set
on the service's image with the <code>ENTRYPOINT</code> Dockerfile instruction, <em>and</em>
clears out any default command on the image - meaning that if there's a <code>CMD</code>
instruction in the Dockerfile, it is ignored.</p>
</blockquote>
<h3><a id="user-content-env_file" class="anchor" aria-hidden="true" href="#env_file"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>env_file</h3>
<p>Add environment variables from a file. Can be a single value or a list.</p>
<p>If you have specified a Compose file with <code>docker-compose -f FILE</code>, paths in
<code>env_file</code> are relative to the directory that file is in.</p>
<p>Environment variables declared in the <a href="#environment">environment</a> section
<em>override</em> these values – this holds true even if those values are
empty or undefined.</p>
<pre><code>env_file: .env

env_file:
  - ./common.env
  - ./apps/web.env
  - /opt/secrets.env
</code></pre>
<p>Compose expects each line in an env file to be in <code>VAR=VAL</code> format. Lines
beginning with <code>#</code> are treated as comments and are ignored. Blank lines are
also ignored.</p>
<pre><code># Set Rails/Rack environment
RACK_ENV=development
</code></pre>
<blockquote>
<p><strong>Note</strong>: If your service specifies a <a href="#build">build</a> option, variables
defined in environment files are <em>not</em> automatically visible during the
build. Use the <a href="#args">args</a> sub-option of <code>build</code> to define build-time
environment variables.</p>
</blockquote>
<p>The value of <code>VAL</code> is used as is and not modified at all. For example if the
value is surrounded by quotes (as is often the case of shell variables), the
quotes are included in the value passed to Compose.</p>
<p>Keep in mind that <em>the order of files in the list is significant in determining
the value assigned to a variable that shows up more than once</em>. The files in the
list are processed from the top down. For the same variable specified in file
<code>a.env</code> and assigned a different value in file <code>b.env</code>, if <code>b.env</code> is
listed below (after), then the value from <code>b.env</code> stands. For example, given the
following declaration in <code>docker_compose.yml</code>:</p>
<pre lang="none"><code>services:
  some-service:
    env_file:
      - a.env
      - b.env
</code></pre>
<p>And the following files:</p>
<pre lang="none"><code># a.env
VAR=1
</code></pre>
<p>and</p>
<pre lang="none"><code># b.env
VAR=hello
</code></pre>
<p>$VAR is <code>hello</code>.</p>
<h3><a id="user-content-environment" class="anchor" aria-hidden="true" href="#environment"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>environment</h3>
<p>Add environment variables. You can use either an array or a dictionary. Any
boolean values; true, false, yes no, need to be enclosed in quotes to ensure
they are not converted to True or False by the YML parser.</p>
<p>Environment variables with only a key are resolved to their values on the
machine Compose is running on, which can be helpful for secret or host-specific values.</p>
<pre><code>environment:
  RACK_ENV: development
  SHOW: 'true'
  SESSION_SECRET:

environment:
  - RACK_ENV=development
  - SHOW=true
  - SESSION_SECRET
</code></pre>
<blockquote>
<p><strong>Note</strong>: If your service specifies a <a href="#build">build</a> option, variables
defined in <code>environment</code> are <em>not</em> automatically visible during the
build. Use the <a href="#args">args</a> sub-option of <code>build</code> to define build-time
environment variables.</p>
</blockquote>
<h3><a id="user-content-expose" class="anchor" aria-hidden="true" href="#expose"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>expose</h3>
<p>Expose ports without publishing them to the host machine - they'll only be
accessible to linked services. Only the internal port can be specified.</p>
<pre><code>expose:
 - "3000"
 - "8000"
</code></pre>
<h3><a id="user-content-external_links" class="anchor" aria-hidden="true" href="#external_links"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>external_links</h3>
<p>Link to containers started outside this <code>docker-compose.yml</code> or even outside of
Compose, especially for containers that provide shared or common services.
<code>external_links</code> follow semantics similar to the legacy option <code>links</code> when
specifying both the container name and the link alias (<code>CONTAINER:ALIAS</code>).</p>
<pre><code>external_links:
 - redis_1
 - project_db_1:mysql
 - project_db_1:postgresql
</code></pre>
<blockquote>
<p><strong>Notes:</strong></p>
<p>If you're using the <a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-2">version 2 or above file format</a>, the externally-created  containers
must be connected to at least one of the same networks as the service that is
linking to them. <a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-file-v2#links">Links</a> are a
legacy option. We recommend using <a href="#networks">networks</a> instead.</p>
<p>This option is ignored when <a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file.</p>
</blockquote>
<h3><a id="user-content-extra_hosts" class="anchor" aria-hidden="true" href="#extra_hosts"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>extra_hosts</h3>
<p>Add hostname mappings. Use the same values as the docker client <code>--add-host</code> parameter.</p>
<pre><code>extra_hosts:
 - "somehost:162.242.195.82"
 - "otherhost:50.31.209.229"
</code></pre>
<p>An entry with the ip address and hostname is created in <code>/etc/hosts</code> inside containers for this service, e.g:</p>
<pre><code>162.242.195.82  somehost
50.31.209.229   otherhost
</code></pre>
<h3><a id="user-content-healthcheck" class="anchor" aria-hidden="true" href="#healthcheck"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>healthcheck</h3>
<blockquote>
<p><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-21">Version 2.1 file format</a> and up.</p>
</blockquote>
<p>Configure a check that's run to determine whether or not containers for this
service are "healthy". See the docs for the
<a href="/docker/docker.github.io/blob/master/engine/reference/builder.md#healthcheck">HEALTHCHECK Dockerfile instruction</a>
for details on how healthchecks work.</p>
<pre><code>healthcheck:
  test: ["CMD", "curl", "-f", "http://localhost"]
  interval: 1m30s
  timeout: 10s
  retries: 3
  start_period: 40s
</code></pre>
<p><code>interval</code>, <code>timeout</code> and <code>start_period</code> are specified as <a href="#specifying-durations">durations</a>.</p>
<blockquote>
<p><strong>Note</strong>: <code>start_period</code> is only supported for v3.4 and higher of the compose
file format.</p>
</blockquote>
<p><code>test</code> must be either a string or a list. If it's a list, the first item must be
either <code>NONE</code>, <code>CMD</code> or <code>CMD-SHELL</code>. If it's a string, it's equivalent to
specifying <code>CMD-SHELL</code> followed by that string.</p>
<pre><code># Hit the local web app
test: ["CMD", "curl", "-f", "http://localhost"]

# As above, but wrapped in /bin/sh. Both forms below are equivalent.
test: ["CMD-SHELL", "curl -f http://localhost || exit 1"]
test: curl -f https://localhost || exit 1
</code></pre>
<p>To disable any default healthcheck set by the image, you can use <code>disable: true</code>. This is equivalent to specifying <code>test: ["NONE"]</code>.</p>
<pre><code>healthcheck:
  disable: true
</code></pre>
<h3><a id="user-content-image" class="anchor" aria-hidden="true" href="#image"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>image</h3>
<p>Specify the image to start the container from. Can either be a repository/tag or
a partial image ID.</p>
<pre><code>image: redis
image: ubuntu:14.04
image: tutum/influxdb
image: example-registry.com:4000/postgresql
image: a4bc65fd
</code></pre>
<p>If the image does not exist, Compose attempts to pull it, unless you have also
specified <a href="#build">build</a>, in which case it builds it using the specified
options and tags it with the specified tag.</p>
<h3><a id="user-content-isolation" class="anchor" aria-hidden="true" href="#isolation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>isolation</h3>
<p>Specify a container’s isolation technology. On Linux, the only supported value
is <code>default</code>. On Windows, acceptable values are <code>default</code>, <code>process</code> and
<code>hyperv</code>. Refer to the
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/run.md#specify-isolation-technology-for-container---isolation">Docker Engine docs</a>
for details.</p>
<h3><a id="user-content-labels-2" class="anchor" aria-hidden="true" href="#labels-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>labels</h3>
<p>Add metadata to containers using <a href="/docker/docker.github.io/blob/master/engine/userguide/labels-custom-metadata.md">Docker labels</a>. You can use either an array or a dictionary.</p>
<p>It's recommended that you use reverse-DNS notation to prevent your labels from conflicting with those used by other software.</p>
<pre><code>labels:
  com.example.description: "Accounting webapp"
  com.example.department: "Finance"
  com.example.label-with-empty-value: ""

labels:
  - "com.example.description=Accounting webapp"
  - "com.example.department=Finance"
  - "com.example.label-with-empty-value"
</code></pre>
<h3><a id="user-content-links" class="anchor" aria-hidden="true" href="#links"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>links</h3>
<blockquote>
<p><strong>Warning</strong>: &gt;The <code>--link</code> flag is a legacy feature of Docker. It
may eventually be removed. Unless you absolutely need to continue using it, we
recommend that you use <a href="/docker/docker.github.io/blob/master/engine/userguide/networking/#user-defined-networks">user-defined networks</a>
to facilitate communication between two containers instead of using <code>--link</code>.
One feature that user-defined networks do not support that you can do with
<code>--link</code> is sharing environmental variables between containers. However, you can
use other mechanisms such as volumes to share environment variables between
containers in a more controlled way.
{:.warning}</p>
</blockquote>
<p>Link to containers in another service. Either specify both the service name and
a link alias (<code>SERVICE:ALIAS</code>), or just the service name.</p>
<pre><code>web:
  links:
   - db
   - db:database
   - redis
</code></pre>
<p>Containers for the linked service are reachable at a hostname identical to
the alias, or the service name if no alias was specified.</p>
<p>Links are not required to enable services to communicate - by default,
any service can reach any other service at that service’s name. (See also, the
<a href="/docker/docker.github.io/blob/master/compose/networking.md#links">Links topic in Networking in Compose</a>.)</p>
<p>Links also express dependency between services in the same way as
<a href="#depends_on">depends_on</a>, so they determine the order of service startup.</p>
<blockquote>
<p><strong>Notes</strong></p>
<ul>
<li>
<p>If you define both links and <a href="#networks">networks</a>, services with
links between them must share at least one network in common to
communicate.</p>
</li>
<li>
<p>This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file.</p>
</li>
</ul>
</blockquote>
<h3><a id="user-content-logging" class="anchor" aria-hidden="true" href="#logging"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>logging</h3>
<p>Logging configuration for the service.</p>
<pre><code>logging:
  driver: syslog
  options:
    syslog-address: "tcp://192.168.0.42:123"
</code></pre>
<p>The <code>driver</code>  name specifies a logging driver for the service's
containers, as with the <code>--log-driver</code> option for docker run
(<a href="/docker/docker.github.io/blob/master/engine/admin/logging/overview.md">documented here</a>).</p>
<p>The default value is json-file.</p>
<pre><code>driver: "json-file"
driver: "syslog"
driver: "none"
</code></pre>
<blockquote>
<p><strong>Note</strong>: Only the <code>json-file</code> and <code>journald</code> drivers make the logs
available directly from <code>docker-compose up</code> and <code>docker-compose logs</code>.
Using any other driver does not print any logs.</p>
</blockquote>
<p>Specify logging options for the logging driver with the <code>options</code> key, as with the <code>--log-opt</code> option for <code>docker run</code>.</p>
<p>Logging options are key-value pairs. An example of <code>syslog</code> options:</p>
<pre><code>driver: "syslog"
options:
  syslog-address: "tcp://192.168.0.42:123"
</code></pre>
<p>The default driver <a href="/docker/docker.github.io/blob/master/engine/admin/logging/overview.md#json-file">json-file</a>, has options to limit the amount of logs stored. To do this, use a key-value pair for maximum storage size and maximum number of files:</p>
<pre><code>options:
  max-size: "200k"
  max-file: "10"
</code></pre>
<p>The example shown above would store log files until they reach a <code>max-size</code> of
200kB, and then rotate them. The amount of individual log files stored is
specified by the <code>max-file</code> value. As logs grow beyond the max limits, older log
files are removed to allow storage of new logs.</p>
<p>Here is an example <code>docker-compose.yml</code> file that limits logging storage:</p>
<pre><code>services:
  some-service:
    image: some-service
    logging:
      driver: "json-file"
      options:
        max-size: "200k"
        max-file: "10"
</code></pre>
<blockquote>
<p>Logging options available depend on which logging driver you use</p>
<p>The above example for controlling log files and sizes uses options
specific to the <a href="/docker/docker.github.io/blob/master/engine/admin/logging/overview.md#json-file">json-file driver</a>.
These particular options are not available on other logging drivers.
For a full list of supported logging drivers and their options, see
<a href="/docker/docker.github.io/blob/master/engine/admin/logging/overview.md">logging drivers</a>.</p>
</blockquote>
<h3><a id="user-content-network_mode" class="anchor" aria-hidden="true" href="#network_mode"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>network_mode</h3>
<p>Network mode. Use the same values as the docker client <code>--net</code> parameter, plus
the special form <code>service:[service name]</code>.</p>
<pre><code>network_mode: "bridge"
network_mode: "host"
network_mode: "none"
network_mode: "service:[service name]"
network_mode: "container:[container name/id]"
</code></pre>
<blockquote>
<p><strong>Notes</strong></p>
<ul>
<li>
<p>This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm
mode</a> with a (version 3) Compose
file.</p>
</li>
<li>
<p><code>network_mode: "host"</code> cannot be mixed with <a href="#links">links</a>.</p>
</li>
</ul>
</blockquote>
<h3><a id="user-content-networks" class="anchor" aria-hidden="true" href="#networks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>networks</h3>
<p>Networks to join, referencing entries under the
<a href="#network-configuration-reference">top-level <code>networks</code> key</a>.</p>
<pre><code>services:
  some-service:
    networks:
     - some-network
     - other-network
</code></pre>
<h4><a id="user-content-aliases" class="anchor" aria-hidden="true" href="#aliases"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>aliases</h4>
<p>Aliases (alternative hostnames) for this service on the network. Other containers on the same network can use either the service name or this alias to connect to one of the service's containers.</p>
<p>Since <code>aliases</code> is network-scoped, the same service can have different aliases on different networks.</p>
<blockquote>
<p><strong>Note</strong>: A network-wide alias can be shared by multiple containers, and even by multiple services. If it is, then exactly which container the name resolves to is not guaranteed.</p>
</blockquote>
<p>The general format is shown here.</p>
<pre><code>services:
  some-service:
    networks:
      some-network:
        aliases:
         - alias1
         - alias3
      other-network:
        aliases:
         - alias2
</code></pre>
<p>In the example below, three services are provided (<code>web</code>, <code>worker</code>, and <code>db</code>),
along with two networks (<code>new</code> and <code>legacy</code>). The <code>db</code> service is reachable at
the hostname <code>db</code> or <code>database</code> on the <code>new</code> network, and at <code>db</code> or <code>mysql</code> on
the <code>legacy</code> network.</p>
<pre><code>version: '2'

services:
  web:
    build: ./web
    networks:
      - new

  worker:
    build: ./worker
    networks:
      - legacy

  db:
    image: mysql
    networks:
      new:
        aliases:
          - database
      legacy:
        aliases:
          - mysql

networks:
  new:
  legacy:
</code></pre>
<h4><a id="user-content-ipv4_address-ipv6_address" class="anchor" aria-hidden="true" href="#ipv4_address-ipv6_address"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ipv4_address, ipv6_address</h4>
<p>Specify a static IP address for containers for this service when joining the network.</p>
<p>The corresponding network configuration in the
<a href="#network-configuration-reference">top-level networks section</a> must have an
<code>ipam</code> block with subnet configurations covering each static address. If IPv6
addressing is desired, the <a href="#enableipv6"><code>enable_ipv6</code></a> option must be set, and
you must use a version 2.x Compose file, such as the one below.</p>
<blockquote>
<p><strong>Note</strong>: These options do not currently work in swarm mode.</p>
</blockquote>
<p>An example:</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">version</span>: <span class="pl-s"><span class="pl-pds">'</span>2.1<span class="pl-pds">'</span></span>

<span class="pl-ent">services</span>:
  <span class="pl-ent">app</span>:
    <span class="pl-ent">image</span>: <span class="pl-s">busybox</span>
    <span class="pl-ent">command</span>: <span class="pl-s">ifconfig</span>
    <span class="pl-ent">networks</span>:
      <span class="pl-ent">app_net</span>:
        <span class="pl-ent">ipv4_address</span>: <span class="pl-s">172.16.238.10</span>
        <span class="pl-ent">ipv6_address</span>: <span class="pl-s">2001:3984:3989::10</span>

<span class="pl-ent">networks</span>:
  <span class="pl-ent">app_net</span>:
    <span class="pl-ent">driver</span>: <span class="pl-s">bridge</span>
    <span class="pl-ent">enable_ipv6</span>: <span class="pl-c1">true</span>
    <span class="pl-ent">ipam</span>:
      <span class="pl-ent">driver</span>: <span class="pl-s">default</span>
      <span class="pl-ent">config</span>:
      -
        <span class="pl-ent">subnet</span>: <span class="pl-s">172.16.238.0/24</span>
      -
        <span class="pl-ent">subnet</span>: <span class="pl-s">2001:3984:3989::/64</span></pre></div>
<h3><a id="user-content-pid" class="anchor" aria-hidden="true" href="#pid"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>pid</h3>
<pre><code>pid: "host"
</code></pre>
<p>Sets the PID mode to the host PID mode.  This turns on sharing between
container and the host operating system the PID address space.  Containers
launched with this flag can access and manipulate other
containers in the bare-metal machine's namespace and vise-versa.</p>
<h3><a id="user-content-ports" class="anchor" aria-hidden="true" href="#ports"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ports</h3>
<p>Expose ports.</p>
<blockquote>
<p><strong>Note:</strong> Port mapping is incompatible with <code>network_mode: host</code></p>
</blockquote>
<h4><a id="user-content-short-syntax-1" class="anchor" aria-hidden="true" href="#short-syntax-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Short syntax</h4>
<p>Either specify both ports (<code>HOST:CONTAINER</code>), or just the container
port (an ephemeral host port is chosen).</p>
<blockquote>
<p><strong>Note</strong>: When mapping ports in the <code>HOST:CONTAINER</code> format, you may experience
erroneous results when using a container port lower than 60, because YAML
parses numbers in the format <code>xx:yy</code> as a base-60 value. For this reason,
we recommend always explicitly specifying your port mappings as strings.</p>
</blockquote>
<pre><code>ports:
 - "3000"
 - "3000-3005"
 - "8000:8000"
 - "9090-9091:8080-8081"
 - "49100:22"
 - "127.0.0.1:8001:8001"
 - "127.0.0.1:5000-5010:5000-5010"
 - "6060:6060/udp"
</code></pre>
<h4><a id="user-content-long-syntax-1" class="anchor" aria-hidden="true" href="#long-syntax-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Long syntax</h4>
<p>The long form syntax allows the configuration of additional fields that can't be
expressed in the short form.</p>
<ul>
<li><code>target</code>: the port inside the container</li>
<li><code>published</code>: the publicly exposed port</li>
<li><code>protocol</code>: the port protocol (<code>tcp</code> or <code>udp</code>)</li>
<li><code>mode</code>: <code>host</code> for publishing a host port on each node, or <code>ingress</code> for a swarm
mode port to be load balanced.</li>
</ul>
<pre lang="none"><code>ports:
  - target: 80
    published: 8080
    protocol: tcp
    mode: host

</code></pre>
<blockquote>
<p><strong>Note:</strong> The long syntax is new in v3.2</p>
</blockquote>
<h3><a id="user-content-secrets" class="anchor" aria-hidden="true" href="#secrets"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>secrets</h3>
<p>Grant access to secrets on a per-service basis using the per-service <code>secrets</code>
configuration. Two different syntax variants are supported.</p>
<blockquote>
<p><strong>Note</strong>: The secret must already exist or be
<a href="#secrets-configuration-reference">defined in the top-level <code>secrets</code> configuration</a>
of this stack file, or stack deployment fails.</p>
</blockquote>
<p>For more information on secrets, see <a href="/docker/docker.github.io/blob/master/engine/swarm/secrets.md">secrets</a>.</p>
<h4><a id="user-content-short-syntax-2" class="anchor" aria-hidden="true" href="#short-syntax-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Short syntax</h4>
<p>The short syntax variant only specifies the secret name. This grants the
container access to the secret and mounts it at <code>/run/secrets/&lt;secret_name&gt;</code>
within the container. The source name and destination mountpoint are both set
to the secret name.</p>
<p>The following example uses the short syntax to grant the <code>redis</code> service
access to the <code>my_secret</code> and <code>my_other_secret</code> secrets. The value of
<code>my_secret</code> is set to the contents of the file <code>./my_secret.txt</code>, and
<code>my_other_secret</code> is defined as an external resource, which means that it has
already been defined in Docker, either by running the <code>docker secret create</code>
command or by another stack deployment. If the external secret does not exist,
the stack deployment fails with a <code>secret not found</code> error.</p>
<pre lang="none"><code>version: "3.1"
services:
  redis:
    image: redis:latest
    deploy:
      replicas: 1
    secrets:
      - my_secret
      - my_other_secret
secrets:
  my_secret:
    file: ./my_secret.txt
  my_other_secret:
    external: true
</code></pre>
<h4><a id="user-content-long-syntax-2" class="anchor" aria-hidden="true" href="#long-syntax-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Long syntax</h4>
<p>The long syntax provides more granularity in how the secret is created within
the service's task containers.</p>
<ul>
<li><code>source</code>: The name of the secret as it exists in Docker.</li>
<li><code>target</code>: The name of the file to be mounted in <code>/run/secrets/</code> in the
service's task containers. Defaults to <code>source</code> if not specified.</li>
<li><code>uid</code> and <code>gid</code>: The numeric UID or GID that owns the file within
<code>/run/secrets/</code> in the service's task containers. Both default to <code>0</code> if not
specified.</li>
<li><code>mode</code>: The permissions for the file to be mounted in <code>/run/secrets/</code>
in the service's task containers, in octal notation. For instance, <code>0444</code>
represents world-readable. The default in Docker 1.13.1 is <code>0000</code>, but is
be <code>0444</code> in newer versions. Secrets cannot be writable because they are mounted
in a temporary filesystem, so if you set the writable bit, it is ignored. The
executable bit can be set. If you aren't familiar with UNIX file permission
modes, you may find this
<a href="http://permissions-calculator.org/" rel="nofollow">permissions calculator</a>{: target="<em>blank" class="</em>" }
useful.</li>
</ul>
<p>The following example sets name of the <code>my_secret</code> to <code>redis_secret</code> within the
container, sets the mode to <code>0440</code> (group-readable) and sets the user and group
to <code>103</code>. The <code>redis</code> service does not have access to the <code>my_other_secret</code>
secret.</p>
<pre lang="none"><code>version: "3.1"
services:
  redis:
    image: redis:latest
    deploy:
      replicas: 1
    secrets:
      - source: my_secret
        target: redis_secret
        uid: '103'
        gid: '103'
        mode: 0440
secrets:
  my_secret:
    file: ./my_secret.txt
  my_other_secret:
    external: true
</code></pre>
<p>You can grant a service access to multiple secrets and you can mix long and
short syntax. Defining a secret does not imply granting a service access to it.</p>
<h3><a id="user-content-security_opt" class="anchor" aria-hidden="true" href="#security_opt"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>security_opt</h3>
<p>Override the default labeling scheme for each container.</p>
<pre><code>security_opt:
  - label:user:USER
  - label:role:ROLE
</code></pre>
<blockquote>
<p><strong>Note</strong>: This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file.</p>
</blockquote>
<h3><a id="user-content-stop_grace_period" class="anchor" aria-hidden="true" href="#stop_grace_period"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>stop_grace_period</h3>
<p>Specify how long to wait when attempting to stop a container if it doesn't
handle SIGTERM (or whatever stop signal has been specified with
<a href="#stopsignal"><code>stop_signal</code></a>), before sending SIGKILL. Specified
as a <a href="#specifying-durations">duration</a>.</p>
<pre><code>stop_grace_period: 1s
stop_grace_period: 1m30s
</code></pre>
<p>By default, <code>stop</code> waits 10 seconds for the container to exit before sending
SIGKILL.</p>
<h3><a id="user-content-stop_signal" class="anchor" aria-hidden="true" href="#stop_signal"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>stop_signal</h3>
<p>Sets an alternative signal to stop the container. By default <code>stop</code> uses
SIGTERM. Setting an alternative signal using <code>stop_signal</code> causes
<code>stop</code> to send that signal instead.</p>
<pre><code>stop_signal: SIGUSR1
</code></pre>
<blockquote>
<p><strong>Note</strong>: This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file.</p>
</blockquote>
<h3><a id="user-content-sysctls" class="anchor" aria-hidden="true" href="#sysctls"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>sysctls</h3>
<p>Kernel parameters to set in the container. You can use either an array or a
dictionary.</p>
<pre><code>sysctls:
  net.core.somaxconn: 1024
  net.ipv4.tcp_syncookies: 0

sysctls:
  - net.core.somaxconn=1024
  - net.ipv4.tcp_syncookies=0
</code></pre>
<blockquote>
<p><strong>Note</strong>: This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file.</p>
</blockquote>
<h3><a id="user-content-ulimits" class="anchor" aria-hidden="true" href="#ulimits"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ulimits</h3>
<p>Override the default ulimits for a container. You can either specify a single
limit as an integer or soft/hard limits as a mapping.</p>
<pre><code>ulimits:
  nproc: 65535
  nofile:
    soft: 20000
    hard: 40000
</code></pre>
<h3><a id="user-content-userns_mode" class="anchor" aria-hidden="true" href="#userns_mode"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>userns_mode</h3>
<pre><code>userns_mode: "host"
</code></pre>
<p>Disables the user namespace for this service, if Docker daemon is configured with user namespaces.
See <a href="/docker/docker.github.io/blob/master/engine/reference/commandline/dockerd.md#disable-user-namespace-for-a-container">dockerd</a> for
more information.</p>
<blockquote>
<p><strong>Note</strong>: This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file.</p>
</blockquote>
<h3><a id="user-content-volumes" class="anchor" aria-hidden="true" href="#volumes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>volumes</h3>
<p>Mount host paths or named volumes, specified as sub-options to a service.</p>
<p>You can mount a host path as part of a definition for a single service, and
there is no need to define it in the top level <code>volumes</code> key.</p>
<p>But, if you want to reuse a volume across multiple services, then define a named
volume in the <a href="#volume-configuration-reference">top-level <code>volumes</code> key</a>. Use
named volumes with <a href="#volumes-for-services-swarms-and-stack-files">services, swarms, and stack
files</a>.</p>
<blockquote>
<p><strong>Note</strong>: The top-level
<a href="#volume-configuration-reference">volumes</a> key defines
a named volume and references it from each service's <code>volumes</code> list. This replaces <code>volumes_from</code> in earlier versions of the Compose file format. See <a href="/docker/docker.github.io/blob/master/engine/admin/volumes/volumes.md">Use volumes</a> and <a href="/docker/docker.github.io/blob/master/engine/extend/plugins_volume.md">Volume
Plugins</a> for general information on volumes.</p>
</blockquote>
<p>This example shows a named volume (<code>mydata</code>) being used by the <code>web</code> service,
and a bind mount defined for a single service (first path under <code>db</code> service
<code>volumes</code>). The <code>db</code> service also uses a named volume called <code>dbdata</code> (second
path under <code>db</code> service <code>volumes</code>), but defines it using the old string format
for mounting a named volume. Named volumes must be listed under the top-level
<code>volumes</code> key, as shown.</p>
<pre lang="none"><code>version: "3.2"
services:
  web:
    image: nginx:alpine
    volumes:
      - type: volume
        source: mydata
        target: /data
        volume:
          nocopy: true
      - type: bind
        source: ./static
        target: /opt/app/static

  db:
    image: postgres:latest
    volumes:
      - "/var/run/postgres/postgres.sock:/var/run/postgres/postgres.sock"
      - "dbdata:/var/lib/postgresql/data"

volumes:
  mydata:
  dbdata:
</code></pre>
<blockquote>
<p><strong>Note</strong>: See <a href="/docker/docker.github.io/blob/master/engine/admin/volumes/volumes.md">Use volumes</a> and <a href="/docker/docker.github.io/blob/master/engine/extend/plugins_volume.md">Volume
Plugins</a> for general information on volumes.</p>
</blockquote>
<h4><a id="user-content-short-syntax-3" class="anchor" aria-hidden="true" href="#short-syntax-3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Short syntax</h4>
<p>Optionally specify a path on the host machine
(<code>HOST:CONTAINER</code>), or an access mode (<code>HOST:CONTAINER:ro</code>).</p>
<p>You can mount a relative path on the host, that expands relative to
the directory of the Compose configuration file being used. Relative paths
should always begin with <code>.</code> or <code>..</code>.</p>
<pre><code>volumes:
  # Just specify a path and let the Engine create a volume
  - /var/lib/mysql

  # Specify an absolute path mapping
  - /opt/data:/var/lib/mysql

  # Path on the host, relative to the Compose file
  - ./cache:/tmp/cache

  # User-relative path
  - ~/configs:/etc/configs/:ro

  # Named volume
  - datavolume:/var/lib/mysql
</code></pre>
<h4><a id="user-content-long-syntax-3" class="anchor" aria-hidden="true" href="#long-syntax-3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Long syntax</h4>
<p>The long form syntax allows the configuration of additional fields that can't be
expressed in the short form.</p>
<ul>
<li><code>type</code>: the mount type <code>volume</code>, <code>bind</code> or <code>tmpfs</code></li>
<li><code>source</code>: the source of the mount, a path on the host for a bind mount, or the
name of a volume defined in the
<a href="#volume-configuration-reference">top-level <code>volumes</code> key</a>. Not applicable for a tmpfs mount.</li>
<li><code>target</code>: the path in the container where the volume is mounted</li>
<li><code>read_only</code>: flag to set the volume as read-only</li>
<li><code>bind</code>: configure additional bind options
<ul>
<li><code>propagation</code>: the propagation mode used for the bind</li>
</ul>
</li>
<li><code>volume</code>: configure additional volume options
<ul>
<li><code>nocopy</code>: flag to disable copying of data from a container when a volume is
created</li>
</ul>
</li>
<li><code>tmpfs</code>: configure additional tmpfs options
<ul>
<li><code>size</code>: the size for the tmpfs mount in bytes</li>
</ul>
</li>
</ul>
<pre lang="none"><code>version: "3.2"
services:
  web:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - type: volume
        source: mydata
        target: /data
        volume:
          nocopy: true
      - type: bind
        source: ./static
        target: /opt/app/static

networks:
  webnet:

volumes:
  mydata:
</code></pre>
<blockquote>
<p><strong>Note:</strong> The long syntax is new in v3.2</p>
</blockquote>
<h4><a id="user-content-volumes-for-services-swarms-and-stack-files" class="anchor" aria-hidden="true" href="#volumes-for-services-swarms-and-stack-files"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Volumes for services, swarms, and stack files</h4>
<p>When working with services, swarms, and <code>docker-stack.yml</code> files, keep in mind
that the tasks (containers) backing a service can be deployed on any node in a
swarm, and this may be a different node each time the service is updated.</p>
<p>In the absence of having named volumes with specified sources, Docker creates an
anonymous volume for each task backing a service. Anonymous volumes do not
persist after the associated containers are removed.</p>
<p>If you want your data to persist, use a named volume and a volume driver that
is multi-host aware, so that the data is accessible from any node. Or, set
constraints on the service so that its tasks are deployed on a node that has the
volume present.</p>
<p>As an example, the <code>docker-stack.yml</code> file for the
<a href="https://github.com/docker/labs/blob/master/beginner/chapters/votingapp.md">votingapp sample in Docker
Labs</a> defines a service called <code>db</code> that runs a <code>postgres</code> database. It is
configured as a named volume to persist the data on the swarm,
<em>and</em> is constrained to run only on <code>manager</code> nodes. Here is the relevant snip-it from that file:</p>
<pre lang="none"><code>version: "3"
services:
  db:
    image: postgres:9.4
    volumes:
      - db-data:/var/lib/postgresql/data
    networks:
      - backend
    deploy:
      placement:
        constraints: [node.role == manager]
</code></pre>
<h4><a id="user-content-caching-options-for-volume-mounts-docker-for-mac" class="anchor" aria-hidden="true" href="#caching-options-for-volume-mounts-docker-for-mac"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Caching options for volume mounts (Docker for Mac)</h4>
<p>On Docker 17.04 CE Edge and up, including 17.06 CE Edge and Stable, you can
configure container-and-host consistency requirements for bind-mounted
directories in Compose files to allow for better performance on read/write of
volume mounts. These options address issues specific to <code>osxfs</code> file sharing,
and therefore are only applicable on Docker for Mac.</p>
<p>The flags are:</p>
<ul>
<li>
<p><code>consistent</code>: Full consistency. The container runtime and the
host maintain an identical view of the mount at all times.  This is the default.</p>
</li>
<li>
<p><code>cached</code>: The host's view of the mount is authoritative. There may be
delays before updates made on the host are visible within a container.</p>
</li>
<li>
<p><code>delegated</code>: The container runtime's view of the mount is
authoritative. There may be delays before updates made in a container
are visible on the host.</p>
</li>
</ul>
<p>Here is an example of configuring a volume as <code>cached</code>:</p>
<pre lang="none"><code>version: '3'
services:
  php:
    image: php:7.1-fpm
    ports:
      - "9000"
    volumes:
      - .:/var/www/project:cached
</code></pre>
<p>Full detail on these flags, the problems they solve, and their
<code>docker run</code> counterparts is in the Docker for Mac topic <a href="/docker/docker.github.io/blob/master/docker-for-mac/osxfs-caching.md">Performance tuning for
volume mounts (shared filesystems)</a>.</p>
<h3><a id="user-content-restart" class="anchor" aria-hidden="true" href="#restart"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>restart</h3>
<p><code>no</code> is the default restart policy, and it does not restart a container under
any circumstance. When <code>always</code> is specified, the container always restarts. The
<code>on-failure</code> policy restarts a container if the exit code indicates an
on-failure error.</p>
<pre><code>restart: "no"
restart: always
restart: on-failure
restart: unless-stopped
</code></pre>
<blockquote>
<p><strong>Note</strong>: This option is ignored when
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/stack_deploy.md">deploying a stack in swarm mode</a>
with a (version 3) Compose file. Use <a href="#restart_policy">restart_policy</a> instead.</p>
</blockquote>
<h3><a id="user-content-domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir" class="anchor" aria-hidden="true" href="#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>domainname, hostname, ipc, mac_address, privileged, read_only, shm_size, stdin_open, tty, user, working_dir</h3>
<p>Each of these is a single value, analogous to its
<a href="/docker/docker.github.io/blob/master/engine/reference/run.md">docker run</a> counterpart.</p>
<pre><code>user: postgresql
working_dir: /code

domainname: foo.com
hostname: foo
ipc: host
mac_address: 02:42:ac:11:65:43

privileged: true


read_only: true
shm_size: 64M
stdin_open: true
tty: true
</code></pre>
<h2><a id="user-content-specifying-durations" class="anchor" aria-hidden="true" href="#specifying-durations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Specifying durations</h2>
<p>Some configuration options, such as the <code>interval</code> and <code>timeout</code> sub-options for
<a href="#healthcheck"><code>check</code></a>, accept a duration as a string in a
format that looks like this:</p>
<pre><code>2.5s
10s
1m30s
2h32m
5h34m56s
</code></pre>
<p>The supported units are <code>us</code>, <code>ms</code>, <code>s</code>, <code>m</code> and <code>h</code>.</p>
<h2><a id="user-content-specifying-byte-values" class="anchor" aria-hidden="true" href="#specifying-byte-values"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Specifying byte values</h2>
<p>Some configuration options, such as the <code>shm_size</code> sub-option for
<a href="#build"><code>build</code></a>, accept a byte value as a string in a format
that looks like this:</p>
<pre><code>2b
1024kb
2048k
300m
1gb
</code></pre>
<p>The supported units are <code>b</code>, <code>k</code>, <code>m</code> and <code>g</code>, and their alternative notation <code>kb</code>,
<code>mb</code> and <code>gb</code>. Decimal values are not supported at this time.</p>
<h2><a id="user-content-volume-configuration-reference" class="anchor" aria-hidden="true" href="#volume-configuration-reference"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Volume configuration reference</h2>
<p>While it is possible to declare <a href="#volumes">volumes</a> on the file as part of the
service declaration, this section allows you to create named volumes (without
relying on <code>volumes_from</code>) that can be reused across multiple services, and are
easily retrieved and inspected using the docker command line or API. See the
<a href="/docker/docker.github.io/blob/master/engine/reference/commandline/volume_create.md">docker volume</a> subcommand
documentation for more information.</p>
<p>See <a href="/docker/docker.github.io/blob/master/engine/admin/volumes/volumes.md">Use volumes</a> and <a href="/docker/docker.github.io/blob/master/engine/extend/plugins_volume.md">Volume
Plugins</a> for general information on volumes.</p>
<p>Here's an example of a two-service setup where a database's data directory is
shared with another service as a volume so that it can be periodically backed
up:</p>
<pre><code>version: "3"

services:
  db:
    image: db
    volumes:
      - data-volume:/var/lib/db
  backup:
    image: backup-service
    volumes:
      - data-volume:/var/lib/backup/data

volumes:
  data-volume:
</code></pre>
<p>An entry under the top-level <code>volumes</code> key can be empty, in which case it
uses the default driver configured by the Engine (in most cases, this is the
<code>local</code> driver). Optionally, you can configure it with the following keys:</p>
<h3><a id="user-content-driver" class="anchor" aria-hidden="true" href="#driver"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>driver</h3>
<p>Specify which volume driver should be used for this volume. Defaults to whatever
driver the Docker Engine has been configured to use, which in most cases is
<code>local</code>. If the driver is not available, the Engine returns an error when
<code>docker-compose up</code> tries to create the volume.</p>
<pre><code> driver: foobar
</code></pre>
<h3><a id="user-content-driver_opts" class="anchor" aria-hidden="true" href="#driver_opts"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>driver_opts</h3>
<p>Specify a list of options as key-value pairs to pass to the driver for this
volume. Those options are driver-dependent - consult the driver's
documentation for more information. Optional.</p>
<pre><code> driver_opts:
   foo: "bar"
   baz: 1
</code></pre>
<h3><a id="user-content-external" class="anchor" aria-hidden="true" href="#external"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>external</h3>
<p>If set to <code>true</code>, specifies that this volume has been created outside of
Compose. <code>docker-compose up</code> does not attempt to create it, and raises
an error if it doesn't exist.</p>
<p><code>external</code> cannot be used in conjunction with other volume configuration keys
(<code>driver</code>, <code>driver_opts</code>).</p>
<p>In the example below, instead of attempting to create a volume called
<code>[projectname]_data</code>, Compose looks for an existing volume simply
called <code>data</code> and mount it into the <code>db</code> service's containers.</p>
<pre><code>version: '2'

services:
  db:
    image: postgres
    volumes:
      - data:/var/lib/postgresql/data

volumes:
  data:
    external: true
</code></pre>
<blockquote>
<p><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-34">external.name was deprecated in version 3.4 file format</a>
use <code>name</code> instead.</p>
</blockquote>
<p>You can also specify the name of the volume separately from the name used to
refer to it within the Compose file:</p>
<pre><code>volumes:
  data:
    external:
      name: actual-name-of-volume
</code></pre>
<blockquote>
<p>External volumes are always created with docker stack deploy</p>
</blockquote>
<p>External volumes that do not exist <em>are created</em> if you use <a href="#deploy">docker stack
deploy</a> to launch the app in <a href="/docker/docker.github.io/blob/master/engine/swarm/index.md">swarm mode</a>
(instead of <a href="/docker/docker.github.io/blob/master/compose/reference/up.md">docker compose up</a>). In swarm mode, a
volume is automatically created when it is defined by a service. As service
tasks are scheduled on new nodes,
<a href="https://github.com/docker/swarmkit/blob/master/README.md">swarmkit</a> creates the
volume on the local node. To learn more, see
<a href="https://github.com/moby/moby/issues/29976">moby/moby#29976</a>.</p>
<h3><a id="user-content-labels-3" class="anchor" aria-hidden="true" href="#labels-3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>labels</h3>
<p>Add metadata to containers using
<a href="/docker/docker.github.io/blob/master/engine/userguide/labels-custom-metadata.md">Docker labels</a>. You can use either
an array or a dictionary.</p>
<p>It's recommended that you use reverse-DNS notation to prevent your labels from
conflicting with those used by other software.</p>
<pre><code>labels:
  com.example.description: "Database volume"
  com.example.department: "IT/Ops"
  com.example.label-with-empty-value: ""

labels:
  - "com.example.description=Database volume"
  - "com.example.department=IT/Ops"
  - "com.example.label-with-empty-value"
</code></pre>
<h3><a id="user-content-name" class="anchor" aria-hidden="true" href="#name"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>name</h3>
<blockquote>
<p><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-34">Added in version 3.4 file format</a></p>
</blockquote>
<p>Set a custom name for this volume. The name field can be used to reference
networks that contain special characters. The name is used as is
and will <strong>not</strong> be scoped with the stack name.</p>
<pre><code>version: '3.4'
volumes:
  data:
    name: my-app-data
</code></pre>
<p>It can also be used in conjuction with the <code>external</code> property:</p>
<pre><code>version: '3.4'
volumes:
  data:
    external: true
    name: my-app-data
</code></pre>
<h2><a id="user-content-network-configuration-reference" class="anchor" aria-hidden="true" href="#network-configuration-reference"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Network configuration reference</h2>
<p>The top-level <code>networks</code> key lets you specify networks to be created.</p>
<ul>
<li>
<p>For a full explanation of Compose's use of Docker networking features and all
network driver options, see the <a href="/docker/docker.github.io/blob/master/compose/networking.md">Networking guide</a>.</p>
</li>
<li>
<p>For <a href="https://github.com/docker/labs/blob/master/README.md">Docker Labs</a>
tutorials on networking, start with <a href="https://github.com/docker/labs/blob/master/networking/README.md">Designing Scalable, Portable Docker
Container
Networks</a></p>
</li>
</ul>
<h3><a id="user-content-driver-1" class="anchor" aria-hidden="true" href="#driver-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>driver</h3>
<p>Specify which driver should be used for this network.</p>
<p>The default driver depends on how the Docker Engine you're using is configured,
but in most instances it is <code>bridge</code> on a single host and <code>overlay</code> on a
Swarm.</p>
<p>The Docker Engine returns an error if the driver is not available.</p>
<pre><code>driver: overlay
</code></pre>
<h4><a id="user-content-bridge" class="anchor" aria-hidden="true" href="#bridge"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>bridge</h4>
<p>Docker defaults to using a <code>bridge</code> network on a single host. For examples of
how to work with bridge networks, see the Docker Labs tutorial on <a href="https://github.com/docker/labs/blob/master/networking/A2-bridge-networking.md">Bridge
networking</a>.</p>
<h4><a id="user-content-overlay" class="anchor" aria-hidden="true" href="#overlay"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>overlay</h4>
<p>The <code>overlay</code> driver creates a named network across multiple nodes in a
<a href="/docker/docker.github.io/blob/master/engine/swarm">swarm</a>.</p>
<ul>
<li>
<p>For a working example of how to build and use an
<code>overlay</code> network with a service in swarm mode, see the Docker Labs tutorial on
<a href="https://github.com/docker/labs/blob/master/networking/A3-overlay-networking.md">Overlay networking and service
discovery</a>.</p>
</li>
<li>
<p>For an in-depth look at how it works under the hood, see the
networking concepts lab on the <a href="https://github.com/docker/labs/blob/master/networking/concepts/06-overlay-networks.md">Overlay Driver Network
Architecture</a>.</p>
</li>
</ul>
<h4><a id="user-content-host-or-none" class="anchor" aria-hidden="true" href="#host-or-none"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>host or none</h4>
<p>Use the host's networking stack, or no networking. Equivalent to
<code>docker run --net=host</code> or <code>docker run --net=none</code>. Only used if you use
<code>docker stack</code> commands. If you use the <code>docker-compose</code> command,
use <a href="#network_mode">network_mode</a> instead.</p>
<p>The syntax for using built-in networks like <code>host</code> and <code>none</code> is a little
different. Define an external network with the name <code>host</code> or <code>none</code> (that
Docker has already created automatically) and an alias that Compose can use
(<code>hostnet</code> or <code>nonet</code> in these examples), then grant the service access to that
network, using the alias.</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">services</span>:
  <span class="pl-ent">web</span>:
    <span class="pl-s">...</span>
    <span class="pl-ent">networks</span>:
      <span class="pl-ent">hostnet</span>: <span class="pl-s">{}</span>

<span class="pl-ent">networks</span>:
  <span class="pl-ent">hostnet</span>:
    <span class="pl-ent">external</span>: <span class="pl-c1">true</span>
    <span class="pl-ent">name</span>: <span class="pl-s">host</span></pre></div>
<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">services</span>:
  <span class="pl-ent">web</span>:
    <span class="pl-s">...</span>
    <span class="pl-ent">networks</span>:
      <span class="pl-ent">nonet</span>: <span class="pl-s">{}</span>

<span class="pl-ent">networks</span>:
  <span class="pl-ent">nonet</span>:
    <span class="pl-ent">external</span>: <span class="pl-c1">true</span>
    <span class="pl-ent">name</span>: <span class="pl-s">none</span></pre></div>
<h3><a id="user-content-driver_opts-1" class="anchor" aria-hidden="true" href="#driver_opts-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>driver_opts</h3>
<p>Specify a list of options as key-value pairs to pass to the driver for this
network. Those options are driver-dependent - consult the driver's
documentation for more information. Optional.</p>
<pre><code>  driver_opts:
    foo: "bar"
    baz: 1
</code></pre>
<h3><a id="user-content-attachable" class="anchor" aria-hidden="true" href="#attachable"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>attachable</h3>
<blockquote>
<p><strong>Note</strong>: Only supported for v3.2 and higher.</p>
</blockquote>
<p>Only used when the <code>driver</code> is set to <code>overlay</code>. If set to <code>true</code>, then
standalone containers can attach to this network, in addition to services. If a
standalone container attaches to an overlay network, it can communicate with
services and standalone containers that are also attached to the overlay
network from other Docker daemons.</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">networks</span>:
  <span class="pl-ent">mynet1</span>:
    <span class="pl-ent">driver</span>: <span class="pl-s">overlay</span>
    <span class="pl-ent">attachable</span>: <span class="pl-c1">true</span></pre></div>
<h3><a id="user-content-enable_ipv6" class="anchor" aria-hidden="true" href="#enable_ipv6"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>enable_ipv6</h3>
<p>Enable IPv6 networking on this network.</p>
<blockquote>
<p>Not supported in Compose File version 3</p>
<p><code>enable_ipv6</code> requires you to use a version 2 Compose file, as this directive
is not yet supported in Swarm mode.
{: .warning }</p>
</blockquote>
<h3><a id="user-content-ipam" class="anchor" aria-hidden="true" href="#ipam"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ipam</h3>
<p>Specify custom IPAM config. This is an object with several properties, each of
which is optional:</p>
<ul>
<li><code>driver</code>: Custom IPAM driver, instead of the default.</li>
<li><code>config</code>: A list with zero or more config blocks, each containing any of
the following keys:
<ul>
<li><code>subnet</code>: Subnet in CIDR format that represents a network segment</li>
</ul>
</li>
</ul>
<p>A full example:</p>
<pre><code>ipam:
  driver: default
  config:
    - subnet: 172.28.0.0/16
</code></pre>
<blockquote>
<p><strong>Note</strong>: Additional IPAM configurations, such as <code>gateway</code>, are only honored for version 2 at the moment.</p>
</blockquote>
<h3><a id="user-content-internal" class="anchor" aria-hidden="true" href="#internal"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>internal</h3>
<p>By default, Docker also connects a bridge network to it to provide external
connectivity. If you want to create an externally isolated overlay network,
you can set this option to <code>true</code>.</p>
<h3><a id="user-content-labels-4" class="anchor" aria-hidden="true" href="#labels-4"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>labels</h3>
<p>Add metadata to containers using
<a href="/docker/docker.github.io/blob/master/engine/userguide/labels-custom-metadata.md">Docker labels</a>. You can use either
an array or a dictionary.</p>
<p>It's recommended that you use reverse-DNS notation to prevent your labels from
conflicting with those used by other software.</p>
<pre><code>labels:
  com.example.description: "Financial transaction network"
  com.example.department: "Finance"
  com.example.label-with-empty-value: ""

labels:
  - "com.example.description=Financial transaction network"
  - "com.example.department=Finance"
  - "com.example.label-with-empty-value"
</code></pre>
<h3><a id="user-content-external-1" class="anchor" aria-hidden="true" href="#external-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>external</h3>
<p>If set to <code>true</code>, specifies that this network has been created outside of
Compose. <code>docker-compose up</code> does not attempt to create it, and raises
an error if it doesn't exist.</p>
<p><code>external</code> cannot be used in conjunction with other network configuration keys
(<code>driver</code>, <code>driver_opts</code>, <code>ipam</code>, <code>internal</code>).</p>
<p>In the example below, <code>proxy</code> is the gateway to the outside world. Instead of
attempting to create a network called <code>[projectname]_outside</code>, Compose
looks for an existing network simply called <code>outside</code> and connect the <code>proxy</code>
service's containers to it.</p>
<pre><code>version: '2'

services:
  proxy:
    build: ./proxy
    networks:
      - outside
      - default
  app:
    build: ./app
    networks:
      - default

networks:
  outside:
    external: true
</code></pre>
<blockquote>
<p><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-35">external.name was deprecated in version 3.5 file format</a>
use <code>name</code> instead.</p>
</blockquote>
<p>You can also specify the name of the network separately from the name used to
refer to it within the Compose file:</p>
<pre><code>networks:
  outside:
    external:
      name: actual-name-of-network
</code></pre>
<h3><a id="user-content-name-1" class="anchor" aria-hidden="true" href="#name-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>name</h3>
<blockquote>
<p><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-35">Added in version 3.5 file format</a></p>
</blockquote>
<p>Set a custom name for this network. The name field can be used to reference
networks which contain special characters. The name is used as is
and will <strong>not</strong> be scoped with the stack name.</p>
<pre><code>version: '3.5'
networks:
  network1:
    name: my-app-net
</code></pre>
<p>It can also be used in conjuction with the <code>external</code> property:</p>
<pre><code>version: '3.5'
networks:
  network1:
    external: true
    name: my-app-net
</code></pre>
<h2><a id="user-content-configs-configuration-reference" class="anchor" aria-hidden="true" href="#configs-configuration-reference"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>configs configuration reference</h2>
<p>The top-level <code>configs</code> declaration defines or references
<a href="/docker/docker.github.io/blob/master/engine/swarm/configs.md">configs</a> that can be granted to the services in this
stack. The source of the config is either <code>file</code> or <code>external</code>.</p>
<ul>
<li><code>file</code>: The config is created with the contents of the file at the specified
path.</li>
<li><code>external</code>: If set to true, specifies that this config has already been
created. Docker does not attempt to create it, and if it does not exist, a
<code>config not found</code> error occurs.</li>
<li><code>name</code>: The name of the config object in Docker. This field can be used to
reference configs that contain special characters. The name is used as is
and will <strong>not</strong> be scoped with the stack name. Introduced in version 3.5
file format.</li>
</ul>
<p>In this example, <code>my_first_config</code> is created (as
<code>&lt;stack_name&gt;_my_first_config)</code>when the stack is deployed,
and <code>my_second_config</code> already exists in Docker.</p>
<pre lang="none"><code>configs:
  my_first_config:
    file: ./config_data
  my_second_config:
    external: true
</code></pre>
<p>Another variant for external configs is when the name of the config in Docker
is different from the name that exists within the service. The following
example modifies the previous one to use the external config called
<code>redis_config</code>.</p>
<pre lang="none"><code>configs:
  my_first_config:
    file: ./config_data
  my_second_config:
    external:
      name: redis_config
</code></pre>
<p>You still need to <a href="#configs">grant access to the config</a> to each service in the
stack.</p>
<h2><a id="user-content-secrets-configuration-reference" class="anchor" aria-hidden="true" href="#secrets-configuration-reference"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>secrets configuration reference</h2>
<p>The top-level <code>secrets</code> declaration defines or references
<a href="/docker/docker.github.io/blob/master/engine/swarm/secrets.md">secrets</a> that can be granted to the services in this
stack. The source of the secret is either <code>file</code> or <code>external</code>.</p>
<ul>
<li><code>file</code>: The secret is created with the contents of the file at the specified
path.</li>
<li><code>external</code>: If set to true, specifies that this secret has already been
created. Docker does not attempt to create it, and if it does not exist, a
<code>secret not found</code> error occurs.</li>
<li><code>name</code>: The name of the secret object in Docker. This field can be used to
reference secrets that contain special characters. The name is used as is
and will <strong>not</strong> be scoped with the stack name. Introduced in version 3.5
file format.</li>
</ul>
<p>In this example, <code>my_first_secret</code> is created (as
<code>&lt;stack_name&gt;_my_first_secret)</code>when the stack is deployed,
and <code>my_second_secret</code> already exists in Docker.</p>
<pre lang="none"><code>secrets:
  my_first_secret:
    file: ./secret_data
  my_second_secret:
    external: true
</code></pre>
<p>Another variant for external secrets is when the name of the secret in Docker
is different from the name that exists within the service. The following
example modifies the previous one to use the external secret called
<code>redis_secret</code>.</p>
<pre lang="none"><code>secrets:
  my_first_secret:
    file: ./secret_data
  my_second_secret:
    external:
      name: redis_secret
</code></pre>
<p>You still need to <a href="#secrets">grant access to the secrets</a> to each service in the
stack.</p>
<h2><a id="user-content-variable-substitution" class="anchor" aria-hidden="true" href="#variable-substitution"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Variable substitution</h2>
<p>{% include content/compose-var-sub.md %}</p>
<h2><a id="user-content-extension-fields" class="anchor" aria-hidden="true" href="#extension-fields"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extension fields</h2>
<blockquote>
<p><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md#version-34">Added in version 3.4 file format</a>.</p>
</blockquote>
<p>{% include content/compose-extfields-sub.md %}</p>
<h2><a id="user-content-compose-documentation" class="anchor" aria-hidden="true" href="#compose-documentation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Compose documentation</h2>
<ul>
<li><a href="/docker/docker.github.io/blob/master/compose/index.md">User guide</a></li>
<li><a href="/docker/docker.github.io/blob/master/compose/install">Installing Compose</a></li>
<li><a href="/docker/docker.github.io/blob/master/compose/compose-file/compose-versioning.md">Compose file versions and upgrading</a></li>
<li><a href="/docker/docker.github.io/blob/master/get-started">Get started with Docker</a></li>
<li><a href="/docker/docker.github.io/blob/master/samples">Samples</a></li>
<li><a href="/docker/docker.github.io/blob/master/compose/reference">Command line reference</a></li>
</ul>
</article>
  </div>

  </div>

  <button type="button" data-facebox="#jump-to-line" data-facebox-class="linejump" data-hotkey="l" class="d-none">Jump to Line</button>
  <div id="jump-to-line" style="display:none">
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-jump-to-line-form" action="" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
      <input class="form-control linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" aria-label="Jump to line" autofocus>
      <button type="submit" class="btn">Go</button>
</form>  </div>


  </div>
  <div class="modal-backdrop js-touch-events"></div>
</div>

    </div>
  </div>

  </div>

      
<div class="footer container-lg px-3" role="contentinfo">
  <div class="position-relative d-flex flex-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <ul class="list-style-none d-flex flex-wrap ">
      <li class="mr-3">&copy; 2018 <span title="0.25256s from unicorn-640434434-ht09t">GitHub</span>, Inc.</li>
        <li class="mr-3"><a data-ga-click="Footer, go to terms, text:terms" href="https://github.com/site/terms">Terms</a></li>
        <li class="mr-3"><a data-ga-click="Footer, go to privacy, text:privacy" href="https://github.com/site/privacy">Privacy</a></li>
        <li class="mr-3"><a href="https://help.github.com/articles/github-security/" data-ga-click="Footer, go to security, text:security">Security</a></li>
        <li class="mr-3"><a href="https://status.github.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
        <li><a data-ga-click="Footer, go to help, text:help" href="https://help.github.com">Help</a></li>
    </ul>

    <a aria-label="Homepage" title="GitHub" class="footer-octicon" href="https://github.com">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
</a>
   <ul class="list-style-none d-flex flex-wrap ">
        <li class="mr-3"><a data-ga-click="Footer, go to contact, text:contact" href="https://github.com/contact">Contact GitHub</a></li>
      <li class="mr-3"><a href="https://developer.github.com" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li class="mr-3"><a href="https://training.github.com" data-ga-click="Footer, go to training, text:training">Training</a></li>
      <li class="mr-3"><a href="https://shop.github.com" data-ga-click="Footer, go to shop, text:shop">Shop</a></li>
        <li class="mr-3"><a href="https://blog.github.com" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a data-ga-click="Footer, go to about, text:about" href="https://github.com/about">About</a></li>

    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>
</div>



  <div id="ajax-error-message" class="ajax-error-message flash flash-error">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
    </button>
    You can’t perform that action at this time.
  </div>


    <script crossorigin="anonymous" integrity="sha512-MWhu3P7Ss2c8wk/fvHCiNZ3LNVjHP4kaHYeO7xXrYQ1lt3MODm9jla1+FhjKVzoXk64jc05569Ia9K3Zq0Fd9Q==" type="application/javascript" src="https://assets-cdn.github.com/assets/compat-1c66c88316e8e9eacfac51af6ff01eac.js"></script>
    <script crossorigin="anonymous" integrity="sha512-rTmClkyJxuWVxD3HuXtPq/5kD0857EfJF77T++HayvDGIYtxo5/ctJc8dYwYj/wSbAU4pD6iSTbLDMs8uNVtlQ==" type="application/javascript" src="https://assets-cdn.github.com/assets/frameworks-10f86fbecbc74b507bd240fe66202501.js"></script>
    
    <script crossorigin="anonymous" async="async" integrity="sha512-VZX5e2PAduVwKFBY5IaJk7Bg7BOI7vzsbneQ+XGdrvg4mXNNu7m1NIKRX7M4eFwjEXS49mZJQraPKwvXmDVzvw==" type="application/javascript" src="https://assets-cdn.github.com/assets/github-5c1954d1915cc1eb4f0d7f0959ad2d35.js"></script>
    
    
    
  <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner d-none">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg>
    <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="">Reload</a> to refresh your session.</span>
    <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="">Reload</a> to refresh your session.</span>
  </div>
  <div class="facebox" id="facebox" style="display:none;">
  <div class="facebox-popup">
    <div class="facebox-content" role="dialog" aria-labelledby="facebox-header" aria-describedby="facebox-description">
    </div>
    <button type="button" class="facebox-close js-facebox-close" aria-label="Close modal">
      <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
    </button>
  </div>
</div>

  <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;" tabindex="0">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box box-shadow-large" style="width:360px;">
  </div>
</div>

<div id="hovercard-aria-description" class="sr-only">
  Press h to open a hovercard with more details.
</div>


  </body>
</html>

